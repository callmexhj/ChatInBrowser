"use strict";var M=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function gs(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function ys(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var a=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,a.get?a:{enumerable:!0,get:function(){return n[r]}})}),t}var Wn={exports:{}};function Cs(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Vt={exports:{}};const As={},Bs=Object.freeze(Object.defineProperty({__proto__:null,default:As},Symbol.toStringTag,{value:"Module"})),ws=ys(Bs);var Mr;function W(){return Mr||(Mr=1,function(n,e){(function(t,r){n.exports=r()})(M,function(){var t=t||function(r,a){var s;if(typeof window<"u"&&window.crypto&&(s=window.crypto),typeof self<"u"&&self.crypto&&(s=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(s=globalThis.crypto),!s&&typeof window<"u"&&window.msCrypto&&(s=window.msCrypto),!s&&typeof M<"u"&&M.crypto&&(s=M.crypto),!s&&typeof Cs=="function")try{s=ws}catch{}var o=function(){if(s){if(typeof s.getRandomValues=="function")try{return s.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof s.randomBytes=="function")try{return s.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},c=Object.create||function(){function f(){}return function(d){var m;return f.prototype=d,m=new f,f.prototype=null,m}}(),v={},i=v.lib={},x=i.Base=function(){return{extend:function(f){var d=c(this);return f&&d.mixIn(f),(!d.hasOwnProperty("init")||this.init===d.init)&&(d.init=function(){d.$super.init.apply(this,arguments)}),d.init.prototype=d,d.$super=this,d},create:function(){var f=this.extend();return f.init.apply(f,arguments),f},init:function(){},mixIn:function(f){for(var d in f)f.hasOwnProperty(d)&&(this[d]=f[d]);f.hasOwnProperty("toString")&&(this.toString=f.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),_=i.WordArray=x.extend({init:function(f,d){f=this.words=f||[],d!=a?this.sigBytes=d:this.sigBytes=f.length*4},toString:function(f){return(f||u).stringify(this)},concat:function(f){var d=this.words,m=f.words,w=this.sigBytes,C=f.sigBytes;if(this.clamp(),w%4)for(var A=0;A<C;A++){var b=m[A>>>2]>>>24-A%4*8&255;d[w+A>>>2]|=b<<24-(w+A)%4*8}else for(var k=0;k<C;k+=4)d[w+k>>>2]=m[k>>>2];return this.sigBytes+=C,this},clamp:function(){var f=this.words,d=this.sigBytes;f[d>>>2]&=4294967295<<32-d%4*8,f.length=r.ceil(d/4)},clone:function(){var f=x.clone.call(this);return f.words=this.words.slice(0),f},random:function(f){for(var d=[],m=0;m<f;m+=4)d.push(o());return new _.init(d,f)}}),l=v.enc={},u=l.Hex={stringify:function(f){for(var d=f.words,m=f.sigBytes,w=[],C=0;C<m;C++){var A=d[C>>>2]>>>24-C%4*8&255;w.push((A>>>4).toString(16)),w.push((A&15).toString(16))}return w.join("")},parse:function(f){for(var d=f.length,m=[],w=0;w<d;w+=2)m[w>>>3]|=parseInt(f.substr(w,2),16)<<24-w%8*4;return new _.init(m,d/2)}},p=l.Latin1={stringify:function(f){for(var d=f.words,m=f.sigBytes,w=[],C=0;C<m;C++){var A=d[C>>>2]>>>24-C%4*8&255;w.push(String.fromCharCode(A))}return w.join("")},parse:function(f){for(var d=f.length,m=[],w=0;w<d;w++)m[w>>>2]|=(f.charCodeAt(w)&255)<<24-w%4*8;return new _.init(m,d)}},g=l.Utf8={stringify:function(f){try{return decodeURIComponent(escape(p.stringify(f)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(f){return p.parse(unescape(encodeURIComponent(f)))}},h=i.BufferedBlockAlgorithm=x.extend({reset:function(){this._data=new _.init,this._nDataBytes=0},_append:function(f){typeof f=="string"&&(f=g.parse(f)),this._data.concat(f),this._nDataBytes+=f.sigBytes},_process:function(f){var d,m=this._data,w=m.words,C=m.sigBytes,A=this.blockSize,b=A*4,k=C/b;f?k=r.ceil(k):k=r.max((k|0)-this._minBufferSize,0);var y=k*A,E=r.min(y*4,C);if(y){for(var F=0;F<y;F+=A)this._doProcessBlock(w,F);d=w.splice(0,y),m.sigBytes-=E}return new _.init(d,E)},clone:function(){var f=x.clone.call(this);return f._data=this._data.clone(),f},_minBufferSize:0});i.Hasher=h.extend({cfg:x.extend(),init:function(f){this.cfg=this.cfg.extend(f),this.reset()},reset:function(){h.reset.call(this),this._doReset()},update:function(f){return this._append(f),this._process(),this},finalize:function(f){f&&this._append(f);var d=this._doFinalize();return d},blockSize:16,_createHelper:function(f){return function(d,m){return new f.init(m).finalize(d)}},_createHmacHelper:function(f){return function(d,m){return new B.HMAC.init(f,m).finalize(d)}}});var B=v.algo={};return v}(Math);return t})}(Vt)),Vt.exports}var Jt={exports:{}},Nr;function Wt(){return Nr||(Nr=1,function(n,e){(function(t,r){n.exports=r(W())})(M,function(t){return function(r){var a=t,s=a.lib,o=s.Base,c=s.WordArray,v=a.x64={};v.Word=o.extend({init:function(i,x){this.high=i,this.low=x}}),v.WordArray=o.extend({init:function(i,x){i=this.words=i||[],x!=r?this.sigBytes=x:this.sigBytes=i.length*8},toX32:function(){for(var i=this.words,x=i.length,_=[],l=0;l<x;l++){var u=i[l];_.push(u.high),_.push(u.low)}return c.create(_,this.sigBytes)},clone:function(){for(var i=o.clone.call(this),x=i.words=this.words.slice(0),_=x.length,l=0;l<_;l++)x[l]=x[l].clone();return i}})}(),t})}(Jt)),Jt.exports}var Qt={exports:{}},qr;function Es(){return qr||(qr=1,function(n,e){(function(t,r){n.exports=r(W())})(M,function(t){return function(){if(typeof ArrayBuffer=="function"){var r=t,a=r.lib,s=a.WordArray,o=s.init,c=s.init=function(v){if(v instanceof ArrayBuffer&&(v=new Uint8Array(v)),(v instanceof Int8Array||typeof Uint8ClampedArray<"u"&&v instanceof Uint8ClampedArray||v instanceof Int16Array||v instanceof Uint16Array||v instanceof Int32Array||v instanceof Uint32Array||v instanceof Float32Array||v instanceof Float64Array)&&(v=new Uint8Array(v.buffer,v.byteOffset,v.byteLength)),v instanceof Uint8Array){for(var i=v.byteLength,x=[],_=0;_<i;_++)x[_>>>2]|=v[_]<<24-_%4*8;o.call(this,x,i)}else o.apply(this,arguments)};c.prototype=s}}(),t.lib.WordArray})}(Qt)),Qt.exports}var Yt={exports:{}},Wr;function bs(){return Wr||(Wr=1,function(n,e){(function(t,r){n.exports=r(W())})(M,function(t){return function(){var r=t,a=r.lib,s=a.WordArray,o=r.enc;o.Utf16=o.Utf16BE={stringify:function(v){for(var i=v.words,x=v.sigBytes,_=[],l=0;l<x;l+=2){var u=i[l>>>2]>>>16-l%4*8&65535;_.push(String.fromCharCode(u))}return _.join("")},parse:function(v){for(var i=v.length,x=[],_=0;_<i;_++)x[_>>>1]|=v.charCodeAt(_)<<16-_%2*16;return s.create(x,i*2)}},o.Utf16LE={stringify:function(v){for(var i=v.words,x=v.sigBytes,_=[],l=0;l<x;l+=2){var u=c(i[l>>>2]>>>16-l%4*8&65535);_.push(String.fromCharCode(u))}return _.join("")},parse:function(v){for(var i=v.length,x=[],_=0;_<i;_++)x[_>>>1]|=c(v.charCodeAt(_)<<16-_%2*16);return s.create(x,i*2)}};function c(v){return v<<8&4278255360|v>>>8&16711935}}(),t.enc.Utf16})}(Yt)),Yt.exports}var Zt={exports:{}},Lr;function Te(){return Lr||(Lr=1,function(n,e){(function(t,r){n.exports=r(W())})(M,function(t){return function(){var r=t,a=r.lib,s=a.WordArray,o=r.enc;o.Base64={stringify:function(v){var i=v.words,x=v.sigBytes,_=this._map;v.clamp();for(var l=[],u=0;u<x;u+=3)for(var p=i[u>>>2]>>>24-u%4*8&255,g=i[u+1>>>2]>>>24-(u+1)%4*8&255,h=i[u+2>>>2]>>>24-(u+2)%4*8&255,B=p<<16|g<<8|h,f=0;f<4&&u+f*.75<x;f++)l.push(_.charAt(B>>>6*(3-f)&63));var d=_.charAt(64);if(d)for(;l.length%4;)l.push(d);return l.join("")},parse:function(v){var i=v.length,x=this._map,_=this._reverseMap;if(!_){_=this._reverseMap=[];for(var l=0;l<x.length;l++)_[x.charCodeAt(l)]=l}var u=x.charAt(64);if(u){var p=v.indexOf(u);p!==-1&&(i=p)}return c(v,i,_)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function c(v,i,x){for(var _=[],l=0,u=0;u<i;u++)if(u%4){var p=x[v.charCodeAt(u-1)]<<u%4*2,g=x[v.charCodeAt(u)]>>>6-u%4*2,h=p|g;_[l>>>2]|=h<<24-l%4*8,l++}return s.create(_,l)}}(),t.enc.Base64})}(Zt)),Zt.exports}var e0={exports:{}},zr;function Fs(){return zr||(zr=1,function(n,e){(function(t,r){n.exports=r(W())})(M,function(t){return function(){var r=t,a=r.lib,s=a.WordArray,o=r.enc;o.Base64url={stringify:function(v,i){i===void 0&&(i=!0);var x=v.words,_=v.sigBytes,l=i?this._safe_map:this._map;v.clamp();for(var u=[],p=0;p<_;p+=3)for(var g=x[p>>>2]>>>24-p%4*8&255,h=x[p+1>>>2]>>>24-(p+1)%4*8&255,B=x[p+2>>>2]>>>24-(p+2)%4*8&255,f=g<<16|h<<8|B,d=0;d<4&&p+d*.75<_;d++)u.push(l.charAt(f>>>6*(3-d)&63));var m=l.charAt(64);if(m)for(;u.length%4;)u.push(m);return u.join("")},parse:function(v,i){i===void 0&&(i=!0);var x=v.length,_=i?this._safe_map:this._map,l=this._reverseMap;if(!l){l=this._reverseMap=[];for(var u=0;u<_.length;u++)l[_.charCodeAt(u)]=u}var p=_.charAt(64);if(p){var g=v.indexOf(p);g!==-1&&(x=g)}return c(v,x,l)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function c(v,i,x){for(var _=[],l=0,u=0;u<i;u++)if(u%4){var p=x[v.charCodeAt(u-1)]<<u%4*2,g=x[v.charCodeAt(u)]>>>6-u%4*2,h=p|g;_[l>>>2]|=h<<24-l%4*8,l++}return s.create(_,l)}}(),t.enc.Base64url})}(e0)),e0.exports}var t0={exports:{}},Ur;function He(){return Ur||(Ur=1,function(n,e){(function(t,r){n.exports=r(W())})(M,function(t){return function(r){var a=t,s=a.lib,o=s.WordArray,c=s.Hasher,v=a.algo,i=[];(function(){for(var g=0;g<64;g++)i[g]=r.abs(r.sin(g+1))*4294967296|0})();var x=v.MD5=c.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(g,h){for(var B=0;B<16;B++){var f=h+B,d=g[f];g[f]=(d<<8|d>>>24)&16711935|(d<<24|d>>>8)&4278255360}var m=this._hash.words,w=g[h+0],C=g[h+1],A=g[h+2],b=g[h+3],k=g[h+4],y=g[h+5],E=g[h+6],F=g[h+7],S=g[h+8],O=g[h+9],T=g[h+10],H=g[h+11],V=g[h+12],U=g[h+13],K=g[h+14],j=g[h+15],D=m[0],P=m[1],I=m[2],R=m[3];D=_(D,P,I,R,w,7,i[0]),R=_(R,D,P,I,C,12,i[1]),I=_(I,R,D,P,A,17,i[2]),P=_(P,I,R,D,b,22,i[3]),D=_(D,P,I,R,k,7,i[4]),R=_(R,D,P,I,y,12,i[5]),I=_(I,R,D,P,E,17,i[6]),P=_(P,I,R,D,F,22,i[7]),D=_(D,P,I,R,S,7,i[8]),R=_(R,D,P,I,O,12,i[9]),I=_(I,R,D,P,T,17,i[10]),P=_(P,I,R,D,H,22,i[11]),D=_(D,P,I,R,V,7,i[12]),R=_(R,D,P,I,U,12,i[13]),I=_(I,R,D,P,K,17,i[14]),P=_(P,I,R,D,j,22,i[15]),D=l(D,P,I,R,C,5,i[16]),R=l(R,D,P,I,E,9,i[17]),I=l(I,R,D,P,H,14,i[18]),P=l(P,I,R,D,w,20,i[19]),D=l(D,P,I,R,y,5,i[20]),R=l(R,D,P,I,T,9,i[21]),I=l(I,R,D,P,j,14,i[22]),P=l(P,I,R,D,k,20,i[23]),D=l(D,P,I,R,O,5,i[24]),R=l(R,D,P,I,K,9,i[25]),I=l(I,R,D,P,b,14,i[26]),P=l(P,I,R,D,S,20,i[27]),D=l(D,P,I,R,U,5,i[28]),R=l(R,D,P,I,A,9,i[29]),I=l(I,R,D,P,F,14,i[30]),P=l(P,I,R,D,V,20,i[31]),D=u(D,P,I,R,y,4,i[32]),R=u(R,D,P,I,S,11,i[33]),I=u(I,R,D,P,H,16,i[34]),P=u(P,I,R,D,K,23,i[35]),D=u(D,P,I,R,C,4,i[36]),R=u(R,D,P,I,k,11,i[37]),I=u(I,R,D,P,F,16,i[38]),P=u(P,I,R,D,T,23,i[39]),D=u(D,P,I,R,U,4,i[40]),R=u(R,D,P,I,w,11,i[41]),I=u(I,R,D,P,b,16,i[42]),P=u(P,I,R,D,E,23,i[43]),D=u(D,P,I,R,O,4,i[44]),R=u(R,D,P,I,V,11,i[45]),I=u(I,R,D,P,j,16,i[46]),P=u(P,I,R,D,A,23,i[47]),D=p(D,P,I,R,w,6,i[48]),R=p(R,D,P,I,F,10,i[49]),I=p(I,R,D,P,K,15,i[50]),P=p(P,I,R,D,y,21,i[51]),D=p(D,P,I,R,V,6,i[52]),R=p(R,D,P,I,b,10,i[53]),I=p(I,R,D,P,T,15,i[54]),P=p(P,I,R,D,C,21,i[55]),D=p(D,P,I,R,S,6,i[56]),R=p(R,D,P,I,j,10,i[57]),I=p(I,R,D,P,E,15,i[58]),P=p(P,I,R,D,U,21,i[59]),D=p(D,P,I,R,k,6,i[60]),R=p(R,D,P,I,H,10,i[61]),I=p(I,R,D,P,A,15,i[62]),P=p(P,I,R,D,O,21,i[63]),m[0]=m[0]+D|0,m[1]=m[1]+P|0,m[2]=m[2]+I|0,m[3]=m[3]+R|0},_doFinalize:function(){var g=this._data,h=g.words,B=this._nDataBytes*8,f=g.sigBytes*8;h[f>>>5]|=128<<24-f%32;var d=r.floor(B/4294967296),m=B;h[(f+64>>>9<<4)+15]=(d<<8|d>>>24)&16711935|(d<<24|d>>>8)&4278255360,h[(f+64>>>9<<4)+14]=(m<<8|m>>>24)&16711935|(m<<24|m>>>8)&4278255360,g.sigBytes=(h.length+1)*4,this._process();for(var w=this._hash,C=w.words,A=0;A<4;A++){var b=C[A];C[A]=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360}return w},clone:function(){var g=c.clone.call(this);return g._hash=this._hash.clone(),g}});function _(g,h,B,f,d,m,w){var C=g+(h&B|~h&f)+d+w;return(C<<m|C>>>32-m)+h}function l(g,h,B,f,d,m,w){var C=g+(h&f|B&~f)+d+w;return(C<<m|C>>>32-m)+h}function u(g,h,B,f,d,m,w){var C=g+(h^B^f)+d+w;return(C<<m|C>>>32-m)+h}function p(g,h,B,f,d,m,w){var C=g+(B^(h|~f))+d+w;return(C<<m|C>>>32-m)+h}a.MD5=c._createHelper(x),a.HmacMD5=c._createHmacHelper(x)}(Math),t.MD5})}(t0)),t0.exports}var r0={exports:{}},jr;function Ln(){return jr||(jr=1,function(n,e){(function(t,r){n.exports=r(W())})(M,function(t){return function(){var r=t,a=r.lib,s=a.WordArray,o=a.Hasher,c=r.algo,v=[],i=c.SHA1=o.extend({_doReset:function(){this._hash=new s.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(x,_){for(var l=this._hash.words,u=l[0],p=l[1],g=l[2],h=l[3],B=l[4],f=0;f<80;f++){if(f<16)v[f]=x[_+f]|0;else{var d=v[f-3]^v[f-8]^v[f-14]^v[f-16];v[f]=d<<1|d>>>31}var m=(u<<5|u>>>27)+B+v[f];f<20?m+=(p&g|~p&h)+1518500249:f<40?m+=(p^g^h)+1859775393:f<60?m+=(p&g|p&h|g&h)-1894007588:m+=(p^g^h)-899497514,B=h,h=g,g=p<<30|p>>>2,p=u,u=m}l[0]=l[0]+u|0,l[1]=l[1]+p|0,l[2]=l[2]+g|0,l[3]=l[3]+h|0,l[4]=l[4]+B|0},_doFinalize:function(){var x=this._data,_=x.words,l=this._nDataBytes*8,u=x.sigBytes*8;return _[u>>>5]|=128<<24-u%32,_[(u+64>>>9<<4)+14]=Math.floor(l/4294967296),_[(u+64>>>9<<4)+15]=l,x.sigBytes=_.length*4,this._process(),this._hash},clone:function(){var x=o.clone.call(this);return x._hash=this._hash.clone(),x}});r.SHA1=o._createHelper(i),r.HmacSHA1=o._createHmacHelper(i)}(),t.SHA1})}(r0)),r0.exports}var n0={exports:{}},Xr;function er(){return Xr||(Xr=1,function(n,e){(function(t,r){n.exports=r(W())})(M,function(t){return function(r){var a=t,s=a.lib,o=s.WordArray,c=s.Hasher,v=a.algo,i=[],x=[];(function(){function u(B){for(var f=r.sqrt(B),d=2;d<=f;d++)if(!(B%d))return!1;return!0}function p(B){return(B-(B|0))*4294967296|0}for(var g=2,h=0;h<64;)u(g)&&(h<8&&(i[h]=p(r.pow(g,1/2))),x[h]=p(r.pow(g,1/3)),h++),g++})();var _=[],l=v.SHA256=c.extend({_doReset:function(){this._hash=new o.init(i.slice(0))},_doProcessBlock:function(u,p){for(var g=this._hash.words,h=g[0],B=g[1],f=g[2],d=g[3],m=g[4],w=g[5],C=g[6],A=g[7],b=0;b<64;b++){if(b<16)_[b]=u[p+b]|0;else{var k=_[b-15],y=(k<<25|k>>>7)^(k<<14|k>>>18)^k>>>3,E=_[b-2],F=(E<<15|E>>>17)^(E<<13|E>>>19)^E>>>10;_[b]=y+_[b-7]+F+_[b-16]}var S=m&w^~m&C,O=h&B^h&f^B&f,T=(h<<30|h>>>2)^(h<<19|h>>>13)^(h<<10|h>>>22),H=(m<<26|m>>>6)^(m<<21|m>>>11)^(m<<7|m>>>25),V=A+H+S+x[b]+_[b],U=T+O;A=C,C=w,w=m,m=d+V|0,d=f,f=B,B=h,h=V+U|0}g[0]=g[0]+h|0,g[1]=g[1]+B|0,g[2]=g[2]+f|0,g[3]=g[3]+d|0,g[4]=g[4]+m|0,g[5]=g[5]+w|0,g[6]=g[6]+C|0,g[7]=g[7]+A|0},_doFinalize:function(){var u=this._data,p=u.words,g=this._nDataBytes*8,h=u.sigBytes*8;return p[h>>>5]|=128<<24-h%32,p[(h+64>>>9<<4)+14]=r.floor(g/4294967296),p[(h+64>>>9<<4)+15]=g,u.sigBytes=p.length*4,this._process(),this._hash},clone:function(){var u=c.clone.call(this);return u._hash=this._hash.clone(),u}});a.SHA256=c._createHelper(l),a.HmacSHA256=c._createHmacHelper(l)}(Math),t.SHA256})}(n0)),n0.exports}var a0={exports:{}},Kr;function Ds(){return Kr||(Kr=1,function(n,e){(function(t,r,a){n.exports=r(W(),er())})(M,function(t){return function(){var r=t,a=r.lib,s=a.WordArray,o=r.algo,c=o.SHA256,v=o.SHA224=c.extend({_doReset:function(){this._hash=new s.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var i=c._doFinalize.call(this);return i.sigBytes-=4,i}});r.SHA224=c._createHelper(v),r.HmacSHA224=c._createHmacHelper(v)}(),t.SHA224})}(a0)),a0.exports}var s0={exports:{}},Gr;function zn(){return Gr||(Gr=1,function(n,e){(function(t,r,a){n.exports=r(W(),Wt())})(M,function(t){return function(){var r=t,a=r.lib,s=a.Hasher,o=r.x64,c=o.Word,v=o.WordArray,i=r.algo;function x(){return c.create.apply(c,arguments)}var _=[x(1116352408,3609767458),x(1899447441,602891725),x(3049323471,3964484399),x(3921009573,2173295548),x(961987163,4081628472),x(1508970993,3053834265),x(2453635748,2937671579),x(2870763221,3664609560),x(3624381080,2734883394),x(310598401,1164996542),x(607225278,1323610764),x(1426881987,3590304994),x(1925078388,4068182383),x(2162078206,991336113),x(2614888103,633803317),x(3248222580,3479774868),x(3835390401,2666613458),x(4022224774,944711139),x(264347078,2341262773),x(604807628,2007800933),x(770255983,1495990901),x(1249150122,1856431235),x(1555081692,3175218132),x(1996064986,2198950837),x(2554220882,3999719339),x(2821834349,766784016),x(2952996808,2566594879),x(3210313671,3203337956),x(3336571891,1034457026),x(3584528711,2466948901),x(113926993,3758326383),x(338241895,168717936),x(666307205,1188179964),x(773529912,1546045734),x(1294757372,1522805485),x(1396182291,2643833823),x(1695183700,2343527390),x(1986661051,1014477480),x(2177026350,1206759142),x(2456956037,344077627),x(2730485921,1290863460),x(2820302411,3158454273),x(3259730800,3505952657),x(3345764771,106217008),x(3516065817,3606008344),x(3600352804,1432725776),x(4094571909,1467031594),x(275423344,851169720),x(430227734,3100823752),x(506948616,1363258195),x(659060556,3750685593),x(883997877,3785050280),x(958139571,3318307427),x(1322822218,3812723403),x(1537002063,2003034995),x(1747873779,3602036899),x(1955562222,1575990012),x(2024104815,1125592928),x(2227730452,2716904306),x(2361852424,442776044),x(2428436474,593698344),x(2756734187,3733110249),x(3204031479,2999351573),x(3329325298,3815920427),x(3391569614,3928383900),x(3515267271,566280711),x(3940187606,3454069534),x(4118630271,4000239992),x(116418474,1914138554),x(174292421,2731055270),x(289380356,3203993006),x(460393269,320620315),x(685471733,587496836),x(852142971,1086792851),x(1017036298,365543100),x(1126000580,2618297676),x(1288033470,3409855158),x(1501505948,4234509866),x(1607167915,987167468),x(1816402316,1246189591)],l=[];(function(){for(var p=0;p<80;p++)l[p]=x()})();var u=i.SHA512=s.extend({_doReset:function(){this._hash=new v.init([new c.init(1779033703,4089235720),new c.init(3144134277,2227873595),new c.init(1013904242,4271175723),new c.init(2773480762,1595750129),new c.init(1359893119,2917565137),new c.init(2600822924,725511199),new c.init(528734635,4215389547),new c.init(1541459225,327033209)])},_doProcessBlock:function(p,g){for(var h=this._hash.words,B=h[0],f=h[1],d=h[2],m=h[3],w=h[4],C=h[5],A=h[6],b=h[7],k=B.high,y=B.low,E=f.high,F=f.low,S=d.high,O=d.low,T=m.high,H=m.low,V=w.high,U=w.low,K=C.high,j=C.low,D=A.high,P=A.low,I=b.high,R=b.low,J=k,G=y,se=E,N=F,Ze=S,Me=O,Kt=T,et=H,he=V,ce=U,Ct=K,tt=j,At=D,rt=P,Gt=I,nt=R,pe=0;pe<80;pe++){var de,Fe,Bt=l[pe];if(pe<16)Fe=Bt.high=p[g+pe*2]|0,de=Bt.low=p[g+pe*2+1]|0;else{var br=l[pe-15],Ne=br.high,at=br.low,is=(Ne>>>1|at<<31)^(Ne>>>8|at<<24)^Ne>>>7,Fr=(at>>>1|Ne<<31)^(at>>>8|Ne<<24)^(at>>>7|Ne<<25),Dr=l[pe-2],qe=Dr.high,st=Dr.low,os=(qe>>>19|st<<13)^(qe<<3|st>>>29)^qe>>>6,Sr=(st>>>19|qe<<13)^(st<<3|qe>>>29)^(st>>>6|qe<<26),kr=l[pe-7],cs=kr.high,ls=kr.low,Rr=l[pe-16],xs=Rr.high,Pr=Rr.low;de=Fr+ls,Fe=is+cs+(de>>>0<Fr>>>0?1:0),de=de+Sr,Fe=Fe+os+(de>>>0<Sr>>>0?1:0),de=de+Pr,Fe=Fe+xs+(de>>>0<Pr>>>0?1:0),Bt.high=Fe,Bt.low=de}var fs=he&Ct^~he&At,Ir=ce&tt^~ce&rt,us=J&se^J&Ze^se&Ze,ds=G&N^G&Me^N&Me,hs=(J>>>28|G<<4)^(J<<30|G>>>2)^(J<<25|G>>>7),Or=(G>>>28|J<<4)^(G<<30|J>>>2)^(G<<25|J>>>7),ps=(he>>>14|ce<<18)^(he>>>18|ce<<14)^(he<<23|ce>>>9),ms=(ce>>>14|he<<18)^(ce>>>18|he<<14)^(ce<<23|he>>>9),$r=_[pe],vs=$r.high,Tr=$r.low,le=nt+ms,De=Gt+ps+(le>>>0<nt>>>0?1:0),le=le+Ir,De=De+fs+(le>>>0<Ir>>>0?1:0),le=le+Tr,De=De+vs+(le>>>0<Tr>>>0?1:0),le=le+de,De=De+Fe+(le>>>0<de>>>0?1:0),Hr=Or+ds,_s=hs+us+(Hr>>>0<Or>>>0?1:0);Gt=At,nt=rt,At=Ct,rt=tt,Ct=he,tt=ce,ce=et+le|0,he=Kt+De+(ce>>>0<et>>>0?1:0)|0,Kt=Ze,et=Me,Ze=se,Me=N,se=J,N=G,G=le+Hr|0,J=De+_s+(G>>>0<le>>>0?1:0)|0}y=B.low=y+G,B.high=k+J+(y>>>0<G>>>0?1:0),F=f.low=F+N,f.high=E+se+(F>>>0<N>>>0?1:0),O=d.low=O+Me,d.high=S+Ze+(O>>>0<Me>>>0?1:0),H=m.low=H+et,m.high=T+Kt+(H>>>0<et>>>0?1:0),U=w.low=U+ce,w.high=V+he+(U>>>0<ce>>>0?1:0),j=C.low=j+tt,C.high=K+Ct+(j>>>0<tt>>>0?1:0),P=A.low=P+rt,A.high=D+At+(P>>>0<rt>>>0?1:0),R=b.low=R+nt,b.high=I+Gt+(R>>>0<nt>>>0?1:0)},_doFinalize:function(){var p=this._data,g=p.words,h=this._nDataBytes*8,B=p.sigBytes*8;g[B>>>5]|=128<<24-B%32,g[(B+128>>>10<<5)+30]=Math.floor(h/4294967296),g[(B+128>>>10<<5)+31]=h,p.sigBytes=g.length*4,this._process();var f=this._hash.toX32();return f},clone:function(){var p=s.clone.call(this);return p._hash=this._hash.clone(),p},blockSize:1024/32});r.SHA512=s._createHelper(u),r.HmacSHA512=s._createHmacHelper(u)}(),t.SHA512})}(s0)),s0.exports}var i0={exports:{}},Vr;function Ss(){return Vr||(Vr=1,function(n,e){(function(t,r,a){n.exports=r(W(),Wt(),zn())})(M,function(t){return function(){var r=t,a=r.x64,s=a.Word,o=a.WordArray,c=r.algo,v=c.SHA512,i=c.SHA384=v.extend({_doReset:function(){this._hash=new o.init([new s.init(3418070365,3238371032),new s.init(1654270250,914150663),new s.init(2438529370,812702999),new s.init(355462360,4144912697),new s.init(1731405415,4290775857),new s.init(2394180231,1750603025),new s.init(3675008525,1694076839),new s.init(1203062813,3204075428)])},_doFinalize:function(){var x=v._doFinalize.call(this);return x.sigBytes-=16,x}});r.SHA384=v._createHelper(i),r.HmacSHA384=v._createHmacHelper(i)}(),t.SHA384})}(i0)),i0.exports}var o0={exports:{}},Jr;function ks(){return Jr||(Jr=1,function(n,e){(function(t,r,a){n.exports=r(W(),Wt())})(M,function(t){return function(r){var a=t,s=a.lib,o=s.WordArray,c=s.Hasher,v=a.x64,i=v.Word,x=a.algo,_=[],l=[],u=[];(function(){for(var h=1,B=0,f=0;f<24;f++){_[h+5*B]=(f+1)*(f+2)/2%64;var d=B%5,m=(2*h+3*B)%5;h=d,B=m}for(var h=0;h<5;h++)for(var B=0;B<5;B++)l[h+5*B]=B+(2*h+3*B)%5*5;for(var w=1,C=0;C<24;C++){for(var A=0,b=0,k=0;k<7;k++){if(w&1){var y=(1<<k)-1;y<32?b^=1<<y:A^=1<<y-32}w&128?w=w<<1^113:w<<=1}u[C]=i.create(A,b)}})();var p=[];(function(){for(var h=0;h<25;h++)p[h]=i.create()})();var g=x.SHA3=c.extend({cfg:c.cfg.extend({outputLength:512}),_doReset:function(){for(var h=this._state=[],B=0;B<25;B++)h[B]=new i.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(h,B){for(var f=this._state,d=this.blockSize/2,m=0;m<d;m++){var w=h[B+2*m],C=h[B+2*m+1];w=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360,C=(C<<8|C>>>24)&16711935|(C<<24|C>>>8)&4278255360;var A=f[m];A.high^=C,A.low^=w}for(var b=0;b<24;b++){for(var k=0;k<5;k++){for(var y=0,E=0,F=0;F<5;F++){var A=f[k+5*F];y^=A.high,E^=A.low}var S=p[k];S.high=y,S.low=E}for(var k=0;k<5;k++)for(var O=p[(k+4)%5],T=p[(k+1)%5],H=T.high,V=T.low,y=O.high^(H<<1|V>>>31),E=O.low^(V<<1|H>>>31),F=0;F<5;F++){var A=f[k+5*F];A.high^=y,A.low^=E}for(var U=1;U<25;U++){var y,E,A=f[U],K=A.high,j=A.low,D=_[U];D<32?(y=K<<D|j>>>32-D,E=j<<D|K>>>32-D):(y=j<<D-32|K>>>64-D,E=K<<D-32|j>>>64-D);var P=p[l[U]];P.high=y,P.low=E}var I=p[0],R=f[0];I.high=R.high,I.low=R.low;for(var k=0;k<5;k++)for(var F=0;F<5;F++){var U=k+5*F,A=f[U],J=p[U],G=p[(k+1)%5+5*F],se=p[(k+2)%5+5*F];A.high=J.high^~G.high&se.high,A.low=J.low^~G.low&se.low}var A=f[0],N=u[b];A.high^=N.high,A.low^=N.low}},_doFinalize:function(){var h=this._data,B=h.words;this._nDataBytes*8;var f=h.sigBytes*8,d=this.blockSize*32;B[f>>>5]|=1<<24-f%32,B[(r.ceil((f+1)/d)*d>>>5)-1]|=128,h.sigBytes=B.length*4,this._process();for(var m=this._state,w=this.cfg.outputLength/8,C=w/8,A=[],b=0;b<C;b++){var k=m[b],y=k.high,E=k.low;y=(y<<8|y>>>24)&16711935|(y<<24|y>>>8)&4278255360,E=(E<<8|E>>>24)&16711935|(E<<24|E>>>8)&4278255360,A.push(E),A.push(y)}return new o.init(A,w)},clone:function(){for(var h=c.clone.call(this),B=h._state=this._state.slice(0),f=0;f<25;f++)B[f]=B[f].clone();return h}});a.SHA3=c._createHelper(g),a.HmacSHA3=c._createHmacHelper(g)}(Math),t.SHA3})}(o0)),o0.exports}var c0={exports:{}},Qr;function Rs(){return Qr||(Qr=1,function(n,e){(function(t,r){n.exports=r(W())})(M,function(t){/** @preserve
			(c) 2012 by Cédric Mesnil. All rights reserved.

			Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

			    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
			    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

			THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
			*/return function(r){var a=t,s=a.lib,o=s.WordArray,c=s.Hasher,v=a.algo,i=o.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),x=o.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),_=o.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),l=o.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),u=o.create([0,1518500249,1859775393,2400959708,2840853838]),p=o.create([1352829926,1548603684,1836072691,2053994217,0]),g=v.RIPEMD160=c.extend({_doReset:function(){this._hash=o.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(C,A){for(var b=0;b<16;b++){var k=A+b,y=C[k];C[k]=(y<<8|y>>>24)&16711935|(y<<24|y>>>8)&4278255360}var E=this._hash.words,F=u.words,S=p.words,O=i.words,T=x.words,H=_.words,V=l.words,U,K,j,D,P,I,R,J,G,se;I=U=E[0],R=K=E[1],J=j=E[2],G=D=E[3],se=P=E[4];for(var N,b=0;b<80;b+=1)N=U+C[A+O[b]]|0,b<16?N+=h(K,j,D)+F[0]:b<32?N+=B(K,j,D)+F[1]:b<48?N+=f(K,j,D)+F[2]:b<64?N+=d(K,j,D)+F[3]:N+=m(K,j,D)+F[4],N=N|0,N=w(N,H[b]),N=N+P|0,U=P,P=D,D=w(j,10),j=K,K=N,N=I+C[A+T[b]]|0,b<16?N+=m(R,J,G)+S[0]:b<32?N+=d(R,J,G)+S[1]:b<48?N+=f(R,J,G)+S[2]:b<64?N+=B(R,J,G)+S[3]:N+=h(R,J,G)+S[4],N=N|0,N=w(N,V[b]),N=N+se|0,I=se,se=G,G=w(J,10),J=R,R=N;N=E[1]+j+G|0,E[1]=E[2]+D+se|0,E[2]=E[3]+P+I|0,E[3]=E[4]+U+R|0,E[4]=E[0]+K+J|0,E[0]=N},_doFinalize:function(){var C=this._data,A=C.words,b=this._nDataBytes*8,k=C.sigBytes*8;A[k>>>5]|=128<<24-k%32,A[(k+64>>>9<<4)+14]=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360,C.sigBytes=(A.length+1)*4,this._process();for(var y=this._hash,E=y.words,F=0;F<5;F++){var S=E[F];E[F]=(S<<8|S>>>24)&16711935|(S<<24|S>>>8)&4278255360}return y},clone:function(){var C=c.clone.call(this);return C._hash=this._hash.clone(),C}});function h(C,A,b){return C^A^b}function B(C,A,b){return C&A|~C&b}function f(C,A,b){return(C|~A)^b}function d(C,A,b){return C&b|A&~b}function m(C,A,b){return C^(A|~b)}function w(C,A){return C<<A|C>>>32-A}a.RIPEMD160=c._createHelper(g),a.HmacRIPEMD160=c._createHmacHelper(g)}(),t.RIPEMD160})}(c0)),c0.exports}var l0={exports:{}},Yr;function tr(){return Yr||(Yr=1,function(n,e){(function(t,r){n.exports=r(W())})(M,function(t){(function(){var r=t,a=r.lib,s=a.Base,o=r.enc,c=o.Utf8,v=r.algo;v.HMAC=s.extend({init:function(i,x){i=this._hasher=new i.init,typeof x=="string"&&(x=c.parse(x));var _=i.blockSize,l=_*4;x.sigBytes>l&&(x=i.finalize(x)),x.clamp();for(var u=this._oKey=x.clone(),p=this._iKey=x.clone(),g=u.words,h=p.words,B=0;B<_;B++)g[B]^=1549556828,h[B]^=909522486;u.sigBytes=p.sigBytes=l,this.reset()},reset:function(){var i=this._hasher;i.reset(),i.update(this._iKey)},update:function(i){return this._hasher.update(i),this},finalize:function(i){var x=this._hasher,_=x.finalize(i);x.reset();var l=x.finalize(this._oKey.clone().concat(_));return l}})})()})}(l0)),l0.exports}var x0={exports:{}},Zr;function Ps(){return Zr||(Zr=1,function(n,e){(function(t,r,a){n.exports=r(W(),er(),tr())})(M,function(t){return function(){var r=t,a=r.lib,s=a.Base,o=a.WordArray,c=r.algo,v=c.SHA256,i=c.HMAC,x=c.PBKDF2=s.extend({cfg:s.extend({keySize:128/32,hasher:v,iterations:25e4}),init:function(_){this.cfg=this.cfg.extend(_)},compute:function(_,l){for(var u=this.cfg,p=i.create(u.hasher,_),g=o.create(),h=o.create([1]),B=g.words,f=h.words,d=u.keySize,m=u.iterations;B.length<d;){var w=p.update(l).finalize(h);p.reset();for(var C=w.words,A=C.length,b=w,k=1;k<m;k++){b=p.finalize(b),p.reset();for(var y=b.words,E=0;E<A;E++)C[E]^=y[E]}g.concat(w),f[0]++}return g.sigBytes=d*4,g}});r.PBKDF2=function(_,l,u){return x.create(u).compute(_,l)}}(),t.PBKDF2})}(x0)),x0.exports}var f0={exports:{}},en;function ke(){return en||(en=1,function(n,e){(function(t,r,a){n.exports=r(W(),Ln(),tr())})(M,function(t){return function(){var r=t,a=r.lib,s=a.Base,o=a.WordArray,c=r.algo,v=c.MD5,i=c.EvpKDF=s.extend({cfg:s.extend({keySize:128/32,hasher:v,iterations:1}),init:function(x){this.cfg=this.cfg.extend(x)},compute:function(x,_){for(var l,u=this.cfg,p=u.hasher.create(),g=o.create(),h=g.words,B=u.keySize,f=u.iterations;h.length<B;){l&&p.update(l),l=p.update(x).finalize(_),p.reset();for(var d=1;d<f;d++)l=p.finalize(l),p.reset();g.concat(l)}return g.sigBytes=B*4,g}});r.EvpKDF=function(x,_,l){return i.create(l).compute(x,_)}}(),t.EvpKDF})}(f0)),f0.exports}var u0={exports:{}},tn;function te(){return tn||(tn=1,function(n,e){(function(t,r,a){n.exports=r(W(),ke())})(M,function(t){t.lib.Cipher||function(r){var a=t,s=a.lib,o=s.Base,c=s.WordArray,v=s.BufferedBlockAlgorithm,i=a.enc;i.Utf8;var x=i.Base64,_=a.algo,l=_.EvpKDF,u=s.Cipher=v.extend({cfg:o.extend(),createEncryptor:function(y,E){return this.create(this._ENC_XFORM_MODE,y,E)},createDecryptor:function(y,E){return this.create(this._DEC_XFORM_MODE,y,E)},init:function(y,E,F){this.cfg=this.cfg.extend(F),this._xformMode=y,this._key=E,this.reset()},reset:function(){v.reset.call(this),this._doReset()},process:function(y){return this._append(y),this._process()},finalize:function(y){y&&this._append(y);var E=this._doFinalize();return E},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function y(E){return typeof E=="string"?k:C}return function(E){return{encrypt:function(F,S,O){return y(S).encrypt(E,F,S,O)},decrypt:function(F,S,O){return y(S).decrypt(E,F,S,O)}}}}()});s.StreamCipher=u.extend({_doFinalize:function(){var y=this._process(!0);return y},blockSize:1});var p=a.mode={},g=s.BlockCipherMode=o.extend({createEncryptor:function(y,E){return this.Encryptor.create(y,E)},createDecryptor:function(y,E){return this.Decryptor.create(y,E)},init:function(y,E){this._cipher=y,this._iv=E}}),h=p.CBC=function(){var y=g.extend();y.Encryptor=y.extend({processBlock:function(F,S){var O=this._cipher,T=O.blockSize;E.call(this,F,S,T),O.encryptBlock(F,S),this._prevBlock=F.slice(S,S+T)}}),y.Decryptor=y.extend({processBlock:function(F,S){var O=this._cipher,T=O.blockSize,H=F.slice(S,S+T);O.decryptBlock(F,S),E.call(this,F,S,T),this._prevBlock=H}});function E(F,S,O){var T,H=this._iv;H?(T=H,this._iv=r):T=this._prevBlock;for(var V=0;V<O;V++)F[S+V]^=T[V]}return y}(),B=a.pad={},f=B.Pkcs7={pad:function(y,E){for(var F=E*4,S=F-y.sigBytes%F,O=S<<24|S<<16|S<<8|S,T=[],H=0;H<S;H+=4)T.push(O);var V=c.create(T,S);y.concat(V)},unpad:function(y){var E=y.words[y.sigBytes-1>>>2]&255;y.sigBytes-=E}};s.BlockCipher=u.extend({cfg:u.cfg.extend({mode:h,padding:f}),reset:function(){var y;u.reset.call(this);var E=this.cfg,F=E.iv,S=E.mode;this._xformMode==this._ENC_XFORM_MODE?y=S.createEncryptor:(y=S.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==y?this._mode.init(this,F&&F.words):(this._mode=y.call(S,this,F&&F.words),this._mode.__creator=y)},_doProcessBlock:function(y,E){this._mode.processBlock(y,E)},_doFinalize:function(){var y,E=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(E.pad(this._data,this.blockSize),y=this._process(!0)):(y=this._process(!0),E.unpad(y)),y},blockSize:128/32});var d=s.CipherParams=o.extend({init:function(y){this.mixIn(y)},toString:function(y){return(y||this.formatter).stringify(this)}}),m=a.format={},w=m.OpenSSL={stringify:function(y){var E,F=y.ciphertext,S=y.salt;return S?E=c.create([1398893684,1701076831]).concat(S).concat(F):E=F,E.toString(x)},parse:function(y){var E,F=x.parse(y),S=F.words;return S[0]==1398893684&&S[1]==1701076831&&(E=c.create(S.slice(2,4)),S.splice(0,4),F.sigBytes-=16),d.create({ciphertext:F,salt:E})}},C=s.SerializableCipher=o.extend({cfg:o.extend({format:w}),encrypt:function(y,E,F,S){S=this.cfg.extend(S);var O=y.createEncryptor(F,S),T=O.finalize(E),H=O.cfg;return d.create({ciphertext:T,key:F,iv:H.iv,algorithm:y,mode:H.mode,padding:H.padding,blockSize:y.blockSize,formatter:S.format})},decrypt:function(y,E,F,S){S=this.cfg.extend(S),E=this._parse(E,S.format);var O=y.createDecryptor(F,S).finalize(E.ciphertext);return O},_parse:function(y,E){return typeof y=="string"?E.parse(y,this):y}}),A=a.kdf={},b=A.OpenSSL={execute:function(y,E,F,S,O){if(S||(S=c.random(64/8)),O)var T=l.create({keySize:E+F,hasher:O}).compute(y,S);else var T=l.create({keySize:E+F}).compute(y,S);var H=c.create(T.words.slice(E),F*4);return T.sigBytes=E*4,d.create({key:T,iv:H,salt:S})}},k=s.PasswordBasedCipher=C.extend({cfg:C.cfg.extend({kdf:b}),encrypt:function(y,E,F,S){S=this.cfg.extend(S);var O=S.kdf.execute(F,y.keySize,y.ivSize,S.salt,S.hasher);S.iv=O.iv;var T=C.encrypt.call(this,y,E,O.key,S);return T.mixIn(O),T},decrypt:function(y,E,F,S){S=this.cfg.extend(S),E=this._parse(E,S.format);var O=S.kdf.execute(F,y.keySize,y.ivSize,E.salt,S.hasher);S.iv=O.iv;var T=C.decrypt.call(this,y,E,O.key,S);return T}})}()})}(u0)),u0.exports}var d0={exports:{}},rn;function Is(){return rn||(rn=1,function(n,e){(function(t,r,a){n.exports=r(W(),te())})(M,function(t){return t.mode.CFB=function(){var r=t.lib.BlockCipherMode.extend();r.Encryptor=r.extend({processBlock:function(s,o){var c=this._cipher,v=c.blockSize;a.call(this,s,o,v,c),this._prevBlock=s.slice(o,o+v)}}),r.Decryptor=r.extend({processBlock:function(s,o){var c=this._cipher,v=c.blockSize,i=s.slice(o,o+v);a.call(this,s,o,v,c),this._prevBlock=i}});function a(s,o,c,v){var i,x=this._iv;x?(i=x.slice(0),this._iv=void 0):i=this._prevBlock,v.encryptBlock(i,0);for(var _=0;_<c;_++)s[o+_]^=i[_]}return r}(),t.mode.CFB})}(d0)),d0.exports}var h0={exports:{}},nn;function Os(){return nn||(nn=1,function(n,e){(function(t,r,a){n.exports=r(W(),te())})(M,function(t){return t.mode.CTR=function(){var r=t.lib.BlockCipherMode.extend(),a=r.Encryptor=r.extend({processBlock:function(s,o){var c=this._cipher,v=c.blockSize,i=this._iv,x=this._counter;i&&(x=this._counter=i.slice(0),this._iv=void 0);var _=x.slice(0);c.encryptBlock(_,0),x[v-1]=x[v-1]+1|0;for(var l=0;l<v;l++)s[o+l]^=_[l]}});return r.Decryptor=a,r}(),t.mode.CTR})}(h0)),h0.exports}var p0={exports:{}},an;function $s(){return an||(an=1,function(n,e){(function(t,r,a){n.exports=r(W(),te())})(M,function(t){/** @preserve
 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
 * derived from CryptoJS.mode.CTR
 * Jan Hruby jhruby.web@gmail.com
 */return t.mode.CTRGladman=function(){var r=t.lib.BlockCipherMode.extend();function a(c){if((c>>24&255)===255){var v=c>>16&255,i=c>>8&255,x=c&255;v===255?(v=0,i===255?(i=0,x===255?x=0:++x):++i):++v,c=0,c+=v<<16,c+=i<<8,c+=x}else c+=1<<24;return c}function s(c){return(c[0]=a(c[0]))===0&&(c[1]=a(c[1])),c}var o=r.Encryptor=r.extend({processBlock:function(c,v){var i=this._cipher,x=i.blockSize,_=this._iv,l=this._counter;_&&(l=this._counter=_.slice(0),this._iv=void 0),s(l);var u=l.slice(0);i.encryptBlock(u,0);for(var p=0;p<x;p++)c[v+p]^=u[p]}});return r.Decryptor=o,r}(),t.mode.CTRGladman})}(p0)),p0.exports}var m0={exports:{}},sn;function Ts(){return sn||(sn=1,function(n,e){(function(t,r,a){n.exports=r(W(),te())})(M,function(t){return t.mode.OFB=function(){var r=t.lib.BlockCipherMode.extend(),a=r.Encryptor=r.extend({processBlock:function(s,o){var c=this._cipher,v=c.blockSize,i=this._iv,x=this._keystream;i&&(x=this._keystream=i.slice(0),this._iv=void 0),c.encryptBlock(x,0);for(var _=0;_<v;_++)s[o+_]^=x[_]}});return r.Decryptor=a,r}(),t.mode.OFB})}(m0)),m0.exports}var v0={exports:{}},on;function Hs(){return on||(on=1,function(n,e){(function(t,r,a){n.exports=r(W(),te())})(M,function(t){return t.mode.ECB=function(){var r=t.lib.BlockCipherMode.extend();return r.Encryptor=r.extend({processBlock:function(a,s){this._cipher.encryptBlock(a,s)}}),r.Decryptor=r.extend({processBlock:function(a,s){this._cipher.decryptBlock(a,s)}}),r}(),t.mode.ECB})}(v0)),v0.exports}var _0={exports:{}},cn;function Ms(){return cn||(cn=1,function(n,e){(function(t,r,a){n.exports=r(W(),te())})(M,function(t){return t.pad.AnsiX923={pad:function(r,a){var s=r.sigBytes,o=a*4,c=o-s%o,v=s+c-1;r.clamp(),r.words[v>>>2]|=c<<24-v%4*8,r.sigBytes+=c},unpad:function(r){var a=r.words[r.sigBytes-1>>>2]&255;r.sigBytes-=a}},t.pad.Ansix923})}(_0)),_0.exports}var g0={exports:{}},ln;function Ns(){return ln||(ln=1,function(n,e){(function(t,r,a){n.exports=r(W(),te())})(M,function(t){return t.pad.Iso10126={pad:function(r,a){var s=a*4,o=s-r.sigBytes%s;r.concat(t.lib.WordArray.random(o-1)).concat(t.lib.WordArray.create([o<<24],1))},unpad:function(r){var a=r.words[r.sigBytes-1>>>2]&255;r.sigBytes-=a}},t.pad.Iso10126})}(g0)),g0.exports}var y0={exports:{}},xn;function qs(){return xn||(xn=1,function(n,e){(function(t,r,a){n.exports=r(W(),te())})(M,function(t){return t.pad.Iso97971={pad:function(r,a){r.concat(t.lib.WordArray.create([2147483648],1)),t.pad.ZeroPadding.pad(r,a)},unpad:function(r){t.pad.ZeroPadding.unpad(r),r.sigBytes--}},t.pad.Iso97971})}(y0)),y0.exports}var C0={exports:{}},fn;function Ws(){return fn||(fn=1,function(n,e){(function(t,r,a){n.exports=r(W(),te())})(M,function(t){return t.pad.ZeroPadding={pad:function(r,a){var s=a*4;r.clamp(),r.sigBytes+=s-(r.sigBytes%s||s)},unpad:function(r){for(var a=r.words,s=r.sigBytes-1,s=r.sigBytes-1;s>=0;s--)if(a[s>>>2]>>>24-s%4*8&255){r.sigBytes=s+1;break}}},t.pad.ZeroPadding})}(C0)),C0.exports}var A0={exports:{}},un;function Ls(){return un||(un=1,function(n,e){(function(t,r,a){n.exports=r(W(),te())})(M,function(t){return t.pad.NoPadding={pad:function(){},unpad:function(){}},t.pad.NoPadding})}(A0)),A0.exports}var B0={exports:{}},dn;function zs(){return dn||(dn=1,function(n,e){(function(t,r,a){n.exports=r(W(),te())})(M,function(t){return function(r){var a=t,s=a.lib,o=s.CipherParams,c=a.enc,v=c.Hex,i=a.format;i.Hex={stringify:function(x){return x.ciphertext.toString(v)},parse:function(x){var _=v.parse(x);return o.create({ciphertext:_})}}}(),t.format.Hex})}(B0)),B0.exports}var w0={exports:{}},hn;function Us(){return hn||(hn=1,function(n,e){(function(t,r,a){n.exports=r(W(),Te(),He(),ke(),te())})(M,function(t){return function(){var r=t,a=r.lib,s=a.BlockCipher,o=r.algo,c=[],v=[],i=[],x=[],_=[],l=[],u=[],p=[],g=[],h=[];(function(){for(var d=[],m=0;m<256;m++)m<128?d[m]=m<<1:d[m]=m<<1^283;for(var w=0,C=0,m=0;m<256;m++){var A=C^C<<1^C<<2^C<<3^C<<4;A=A>>>8^A&255^99,c[w]=A,v[A]=w;var b=d[w],k=d[b],y=d[k],E=d[A]*257^A*16843008;i[w]=E<<24|E>>>8,x[w]=E<<16|E>>>16,_[w]=E<<8|E>>>24,l[w]=E;var E=y*16843009^k*65537^b*257^w*16843008;u[A]=E<<24|E>>>8,p[A]=E<<16|E>>>16,g[A]=E<<8|E>>>24,h[A]=E,w?(w=b^d[d[d[y^b]]],C^=d[d[C]]):w=C=1}})();var B=[0,1,2,4,8,16,32,64,128,27,54],f=o.AES=s.extend({_doReset:function(){var d;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var m=this._keyPriorReset=this._key,w=m.words,C=m.sigBytes/4,A=this._nRounds=C+6,b=(A+1)*4,k=this._keySchedule=[],y=0;y<b;y++)y<C?k[y]=w[y]:(d=k[y-1],y%C?C>6&&y%C==4&&(d=c[d>>>24]<<24|c[d>>>16&255]<<16|c[d>>>8&255]<<8|c[d&255]):(d=d<<8|d>>>24,d=c[d>>>24]<<24|c[d>>>16&255]<<16|c[d>>>8&255]<<8|c[d&255],d^=B[y/C|0]<<24),k[y]=k[y-C]^d);for(var E=this._invKeySchedule=[],F=0;F<b;F++){var y=b-F;if(F%4)var d=k[y];else var d=k[y-4];F<4||y<=4?E[F]=d:E[F]=u[c[d>>>24]]^p[c[d>>>16&255]]^g[c[d>>>8&255]]^h[c[d&255]]}}},encryptBlock:function(d,m){this._doCryptBlock(d,m,this._keySchedule,i,x,_,l,c)},decryptBlock:function(d,m){var w=d[m+1];d[m+1]=d[m+3],d[m+3]=w,this._doCryptBlock(d,m,this._invKeySchedule,u,p,g,h,v);var w=d[m+1];d[m+1]=d[m+3],d[m+3]=w},_doCryptBlock:function(d,m,w,C,A,b,k,y){for(var E=this._nRounds,F=d[m]^w[0],S=d[m+1]^w[1],O=d[m+2]^w[2],T=d[m+3]^w[3],H=4,V=1;V<E;V++){var U=C[F>>>24]^A[S>>>16&255]^b[O>>>8&255]^k[T&255]^w[H++],K=C[S>>>24]^A[O>>>16&255]^b[T>>>8&255]^k[F&255]^w[H++],j=C[O>>>24]^A[T>>>16&255]^b[F>>>8&255]^k[S&255]^w[H++],D=C[T>>>24]^A[F>>>16&255]^b[S>>>8&255]^k[O&255]^w[H++];F=U,S=K,O=j,T=D}var U=(y[F>>>24]<<24|y[S>>>16&255]<<16|y[O>>>8&255]<<8|y[T&255])^w[H++],K=(y[S>>>24]<<24|y[O>>>16&255]<<16|y[T>>>8&255]<<8|y[F&255])^w[H++],j=(y[O>>>24]<<24|y[T>>>16&255]<<16|y[F>>>8&255]<<8|y[S&255])^w[H++],D=(y[T>>>24]<<24|y[F>>>16&255]<<16|y[S>>>8&255]<<8|y[O&255])^w[H++];d[m]=U,d[m+1]=K,d[m+2]=j,d[m+3]=D},keySize:256/32});r.AES=s._createHelper(f)}(),t.AES})}(w0)),w0.exports}var E0={exports:{}},pn;function js(){return pn||(pn=1,function(n,e){(function(t,r,a){n.exports=r(W(),Te(),He(),ke(),te())})(M,function(t){return function(){var r=t,a=r.lib,s=a.WordArray,o=a.BlockCipher,c=r.algo,v=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],i=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],x=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],_=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],l=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],u=c.DES=o.extend({_doReset:function(){for(var B=this._key,f=B.words,d=[],m=0;m<56;m++){var w=v[m]-1;d[m]=f[w>>>5]>>>31-w%32&1}for(var C=this._subKeys=[],A=0;A<16;A++){for(var b=C[A]=[],k=x[A],m=0;m<24;m++)b[m/6|0]|=d[(i[m]-1+k)%28]<<31-m%6,b[4+(m/6|0)]|=d[28+(i[m+24]-1+k)%28]<<31-m%6;b[0]=b[0]<<1|b[0]>>>31;for(var m=1;m<7;m++)b[m]=b[m]>>>(m-1)*4+3;b[7]=b[7]<<5|b[7]>>>27}for(var y=this._invSubKeys=[],m=0;m<16;m++)y[m]=C[15-m]},encryptBlock:function(B,f){this._doCryptBlock(B,f,this._subKeys)},decryptBlock:function(B,f){this._doCryptBlock(B,f,this._invSubKeys)},_doCryptBlock:function(B,f,d){this._lBlock=B[f],this._rBlock=B[f+1],p.call(this,4,252645135),p.call(this,16,65535),g.call(this,2,858993459),g.call(this,8,16711935),p.call(this,1,1431655765);for(var m=0;m<16;m++){for(var w=d[m],C=this._lBlock,A=this._rBlock,b=0,k=0;k<8;k++)b|=_[k][((A^w[k])&l[k])>>>0];this._lBlock=A,this._rBlock=C^b}var y=this._lBlock;this._lBlock=this._rBlock,this._rBlock=y,p.call(this,1,1431655765),g.call(this,8,16711935),g.call(this,2,858993459),p.call(this,16,65535),p.call(this,4,252645135),B[f]=this._lBlock,B[f+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function p(B,f){var d=(this._lBlock>>>B^this._rBlock)&f;this._rBlock^=d,this._lBlock^=d<<B}function g(B,f){var d=(this._rBlock>>>B^this._lBlock)&f;this._lBlock^=d,this._rBlock^=d<<B}r.DES=o._createHelper(u);var h=c.TripleDES=o.extend({_doReset:function(){var B=this._key,f=B.words;if(f.length!==2&&f.length!==4&&f.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var d=f.slice(0,2),m=f.length<4?f.slice(0,2):f.slice(2,4),w=f.length<6?f.slice(0,2):f.slice(4,6);this._des1=u.createEncryptor(s.create(d)),this._des2=u.createEncryptor(s.create(m)),this._des3=u.createEncryptor(s.create(w))},encryptBlock:function(B,f){this._des1.encryptBlock(B,f),this._des2.decryptBlock(B,f),this._des3.encryptBlock(B,f)},decryptBlock:function(B,f){this._des3.decryptBlock(B,f),this._des2.encryptBlock(B,f),this._des1.decryptBlock(B,f)},keySize:192/32,ivSize:64/32,blockSize:64/32});r.TripleDES=o._createHelper(h)}(),t.TripleDES})}(E0)),E0.exports}var b0={exports:{}},mn;function Xs(){return mn||(mn=1,function(n,e){(function(t,r,a){n.exports=r(W(),Te(),He(),ke(),te())})(M,function(t){return function(){var r=t,a=r.lib,s=a.StreamCipher,o=r.algo,c=o.RC4=s.extend({_doReset:function(){for(var x=this._key,_=x.words,l=x.sigBytes,u=this._S=[],p=0;p<256;p++)u[p]=p;for(var p=0,g=0;p<256;p++){var h=p%l,B=_[h>>>2]>>>24-h%4*8&255;g=(g+u[p]+B)%256;var f=u[p];u[p]=u[g],u[g]=f}this._i=this._j=0},_doProcessBlock:function(x,_){x[_]^=v.call(this)},keySize:256/32,ivSize:0});function v(){for(var x=this._S,_=this._i,l=this._j,u=0,p=0;p<4;p++){_=(_+1)%256,l=(l+x[_])%256;var g=x[_];x[_]=x[l],x[l]=g,u|=x[(x[_]+x[l])%256]<<24-p*8}return this._i=_,this._j=l,u}r.RC4=s._createHelper(c);var i=o.RC4Drop=c.extend({cfg:c.cfg.extend({drop:192}),_doReset:function(){c._doReset.call(this);for(var x=this.cfg.drop;x>0;x--)v.call(this)}});r.RC4Drop=s._createHelper(i)}(),t.RC4})}(b0)),b0.exports}var F0={exports:{}},vn;function Ks(){return vn||(vn=1,function(n,e){(function(t,r,a){n.exports=r(W(),Te(),He(),ke(),te())})(M,function(t){return function(){var r=t,a=r.lib,s=a.StreamCipher,o=r.algo,c=[],v=[],i=[],x=o.Rabbit=s.extend({_doReset:function(){for(var l=this._key.words,u=this.cfg.iv,p=0;p<4;p++)l[p]=(l[p]<<8|l[p]>>>24)&16711935|(l[p]<<24|l[p]>>>8)&4278255360;var g=this._X=[l[0],l[3]<<16|l[2]>>>16,l[1],l[0]<<16|l[3]>>>16,l[2],l[1]<<16|l[0]>>>16,l[3],l[2]<<16|l[1]>>>16],h=this._C=[l[2]<<16|l[2]>>>16,l[0]&4294901760|l[1]&65535,l[3]<<16|l[3]>>>16,l[1]&4294901760|l[2]&65535,l[0]<<16|l[0]>>>16,l[2]&4294901760|l[3]&65535,l[1]<<16|l[1]>>>16,l[3]&4294901760|l[0]&65535];this._b=0;for(var p=0;p<4;p++)_.call(this);for(var p=0;p<8;p++)h[p]^=g[p+4&7];if(u){var B=u.words,f=B[0],d=B[1],m=(f<<8|f>>>24)&16711935|(f<<24|f>>>8)&4278255360,w=(d<<8|d>>>24)&16711935|(d<<24|d>>>8)&4278255360,C=m>>>16|w&4294901760,A=w<<16|m&65535;h[0]^=m,h[1]^=C,h[2]^=w,h[3]^=A,h[4]^=m,h[5]^=C,h[6]^=w,h[7]^=A;for(var p=0;p<4;p++)_.call(this)}},_doProcessBlock:function(l,u){var p=this._X;_.call(this),c[0]=p[0]^p[5]>>>16^p[3]<<16,c[1]=p[2]^p[7]>>>16^p[5]<<16,c[2]=p[4]^p[1]>>>16^p[7]<<16,c[3]=p[6]^p[3]>>>16^p[1]<<16;for(var g=0;g<4;g++)c[g]=(c[g]<<8|c[g]>>>24)&16711935|(c[g]<<24|c[g]>>>8)&4278255360,l[u+g]^=c[g]},blockSize:128/32,ivSize:64/32});function _(){for(var l=this._X,u=this._C,p=0;p<8;p++)v[p]=u[p];u[0]=u[0]+1295307597+this._b|0,u[1]=u[1]+3545052371+(u[0]>>>0<v[0]>>>0?1:0)|0,u[2]=u[2]+886263092+(u[1]>>>0<v[1]>>>0?1:0)|0,u[3]=u[3]+1295307597+(u[2]>>>0<v[2]>>>0?1:0)|0,u[4]=u[4]+3545052371+(u[3]>>>0<v[3]>>>0?1:0)|0,u[5]=u[5]+886263092+(u[4]>>>0<v[4]>>>0?1:0)|0,u[6]=u[6]+1295307597+(u[5]>>>0<v[5]>>>0?1:0)|0,u[7]=u[7]+3545052371+(u[6]>>>0<v[6]>>>0?1:0)|0,this._b=u[7]>>>0<v[7]>>>0?1:0;for(var p=0;p<8;p++){var g=l[p]+u[p],h=g&65535,B=g>>>16,f=((h*h>>>17)+h*B>>>15)+B*B,d=((g&4294901760)*g|0)+((g&65535)*g|0);i[p]=f^d}l[0]=i[0]+(i[7]<<16|i[7]>>>16)+(i[6]<<16|i[6]>>>16)|0,l[1]=i[1]+(i[0]<<8|i[0]>>>24)+i[7]|0,l[2]=i[2]+(i[1]<<16|i[1]>>>16)+(i[0]<<16|i[0]>>>16)|0,l[3]=i[3]+(i[2]<<8|i[2]>>>24)+i[1]|0,l[4]=i[4]+(i[3]<<16|i[3]>>>16)+(i[2]<<16|i[2]>>>16)|0,l[5]=i[5]+(i[4]<<8|i[4]>>>24)+i[3]|0,l[6]=i[6]+(i[5]<<16|i[5]>>>16)+(i[4]<<16|i[4]>>>16)|0,l[7]=i[7]+(i[6]<<8|i[6]>>>24)+i[5]|0}r.Rabbit=s._createHelper(x)}(),t.Rabbit})}(F0)),F0.exports}var D0={exports:{}},_n;function Gs(){return _n||(_n=1,function(n,e){(function(t,r,a){n.exports=r(W(),Te(),He(),ke(),te())})(M,function(t){return function(){var r=t,a=r.lib,s=a.StreamCipher,o=r.algo,c=[],v=[],i=[],x=o.RabbitLegacy=s.extend({_doReset:function(){var l=this._key.words,u=this.cfg.iv,p=this._X=[l[0],l[3]<<16|l[2]>>>16,l[1],l[0]<<16|l[3]>>>16,l[2],l[1]<<16|l[0]>>>16,l[3],l[2]<<16|l[1]>>>16],g=this._C=[l[2]<<16|l[2]>>>16,l[0]&4294901760|l[1]&65535,l[3]<<16|l[3]>>>16,l[1]&4294901760|l[2]&65535,l[0]<<16|l[0]>>>16,l[2]&4294901760|l[3]&65535,l[1]<<16|l[1]>>>16,l[3]&4294901760|l[0]&65535];this._b=0;for(var h=0;h<4;h++)_.call(this);for(var h=0;h<8;h++)g[h]^=p[h+4&7];if(u){var B=u.words,f=B[0],d=B[1],m=(f<<8|f>>>24)&16711935|(f<<24|f>>>8)&4278255360,w=(d<<8|d>>>24)&16711935|(d<<24|d>>>8)&4278255360,C=m>>>16|w&4294901760,A=w<<16|m&65535;g[0]^=m,g[1]^=C,g[2]^=w,g[3]^=A,g[4]^=m,g[5]^=C,g[6]^=w,g[7]^=A;for(var h=0;h<4;h++)_.call(this)}},_doProcessBlock:function(l,u){var p=this._X;_.call(this),c[0]=p[0]^p[5]>>>16^p[3]<<16,c[1]=p[2]^p[7]>>>16^p[5]<<16,c[2]=p[4]^p[1]>>>16^p[7]<<16,c[3]=p[6]^p[3]>>>16^p[1]<<16;for(var g=0;g<4;g++)c[g]=(c[g]<<8|c[g]>>>24)&16711935|(c[g]<<24|c[g]>>>8)&4278255360,l[u+g]^=c[g]},blockSize:128/32,ivSize:64/32});function _(){for(var l=this._X,u=this._C,p=0;p<8;p++)v[p]=u[p];u[0]=u[0]+1295307597+this._b|0,u[1]=u[1]+3545052371+(u[0]>>>0<v[0]>>>0?1:0)|0,u[2]=u[2]+886263092+(u[1]>>>0<v[1]>>>0?1:0)|0,u[3]=u[3]+1295307597+(u[2]>>>0<v[2]>>>0?1:0)|0,u[4]=u[4]+3545052371+(u[3]>>>0<v[3]>>>0?1:0)|0,u[5]=u[5]+886263092+(u[4]>>>0<v[4]>>>0?1:0)|0,u[6]=u[6]+1295307597+(u[5]>>>0<v[5]>>>0?1:0)|0,u[7]=u[7]+3545052371+(u[6]>>>0<v[6]>>>0?1:0)|0,this._b=u[7]>>>0<v[7]>>>0?1:0;for(var p=0;p<8;p++){var g=l[p]+u[p],h=g&65535,B=g>>>16,f=((h*h>>>17)+h*B>>>15)+B*B,d=((g&4294901760)*g|0)+((g&65535)*g|0);i[p]=f^d}l[0]=i[0]+(i[7]<<16|i[7]>>>16)+(i[6]<<16|i[6]>>>16)|0,l[1]=i[1]+(i[0]<<8|i[0]>>>24)+i[7]|0,l[2]=i[2]+(i[1]<<16|i[1]>>>16)+(i[0]<<16|i[0]>>>16)|0,l[3]=i[3]+(i[2]<<8|i[2]>>>24)+i[1]|0,l[4]=i[4]+(i[3]<<16|i[3]>>>16)+(i[2]<<16|i[2]>>>16)|0,l[5]=i[5]+(i[4]<<8|i[4]>>>24)+i[3]|0,l[6]=i[6]+(i[5]<<16|i[5]>>>16)+(i[4]<<16|i[4]>>>16)|0,l[7]=i[7]+(i[6]<<8|i[6]>>>24)+i[5]|0}r.RabbitLegacy=s._createHelper(x)}(),t.RabbitLegacy})}(D0)),D0.exports}var S0={exports:{}},gn;function Vs(){return gn||(gn=1,function(n,e){(function(t,r,a){n.exports=r(W(),Te(),He(),ke(),te())})(M,function(t){return function(){var r=t,a=r.lib,s=a.BlockCipher,o=r.algo;const c=16,v=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],i=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var x={pbox:[],sbox:[]};function _(h,B){let f=B>>24&255,d=B>>16&255,m=B>>8&255,w=B&255,C=h.sbox[0][f]+h.sbox[1][d];return C=C^h.sbox[2][m],C=C+h.sbox[3][w],C}function l(h,B,f){let d=B,m=f,w;for(let C=0;C<c;++C)d=d^h.pbox[C],m=_(h,d)^m,w=d,d=m,m=w;return w=d,d=m,m=w,m=m^h.pbox[c],d=d^h.pbox[c+1],{left:d,right:m}}function u(h,B,f){let d=B,m=f,w;for(let C=c+1;C>1;--C)d=d^h.pbox[C],m=_(h,d)^m,w=d,d=m,m=w;return w=d,d=m,m=w,m=m^h.pbox[1],d=d^h.pbox[0],{left:d,right:m}}function p(h,B,f){for(let A=0;A<4;A++){h.sbox[A]=[];for(let b=0;b<256;b++)h.sbox[A][b]=i[A][b]}let d=0;for(let A=0;A<c+2;A++)h.pbox[A]=v[A]^B[d],d++,d>=f&&(d=0);let m=0,w=0,C=0;for(let A=0;A<c+2;A+=2)C=l(h,m,w),m=C.left,w=C.right,h.pbox[A]=m,h.pbox[A+1]=w;for(let A=0;A<4;A++)for(let b=0;b<256;b+=2)C=l(h,m,w),m=C.left,w=C.right,h.sbox[A][b]=m,h.sbox[A][b+1]=w;return!0}var g=o.Blowfish=s.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var h=this._keyPriorReset=this._key,B=h.words,f=h.sigBytes/4;p(x,B,f)}},encryptBlock:function(h,B){var f=l(x,h[B],h[B+1]);h[B]=f.left,h[B+1]=f.right},decryptBlock:function(h,B){var f=u(x,h[B],h[B+1]);h[B]=f.left,h[B+1]=f.right},blockSize:64/32,keySize:128/32,ivSize:64/32});r.Blowfish=s._createHelper(g)}(),t.Blowfish})}(S0)),S0.exports}(function(n,e){(function(t,r,a){n.exports=r(W(),Wt(),Es(),bs(),Te(),Fs(),He(),Ln(),er(),Ds(),zn(),Ss(),ks(),Rs(),tr(),Ps(),ke(),te(),Is(),Os(),$s(),Ts(),Hs(),Ms(),Ns(),qs(),Ws(),Ls(),zs(),Us(),js(),Xs(),Ks(),Gs(),Vs())})(M,function(t){return t})})(Wn);var Js=Wn.exports;const yn=gs(Js);let Un=null,jn=null,Xn=null,q0=null,Kn=null,Gn=null,Ie=null;const Qs=n=>{Un=n.appId,jn=n.apiSecret,Xn=n.apiKey,q0=n.path,Kn=n.domain,Gn=new URL(q0).pathname};async function Ys(n,e){const t=JSON.parse(n);if(t.header.code!==0){const s=`${t.header.code}:${t.header.message}`;await chrome.tabs.sendMessage(e.tab.id,{action:"configError",data:s});return}const{payload:{choices:{text:r}}}=t,a=r[r.length-1].content;chrome.tabs.sendMessage(e.tab.id,{action:"websocketMessage",data:a}),t.header.code===0&&t.header.status===2&&Ie.close()}function Zs(){return new Promise((n,e)=>{var t=Xn,r=jn,a=q0,s=location.host,o=new Date().toGMTString(),c="hmac-sha256",v="host date request-line",i=`host: ${s}
date: ${o}
GET ${Gn} HTTP/1.1`,x=yn.HmacSHA256(i,r),_=yn.enc.Base64.stringify(x),l=`api_key="${t}", algorithm="${c}", headers="${v}", signature="${_}"`,u=btoa(l);a=`${a}?authorization=${u}&date=${o}&host=${s}`,n(a)})}const ei=(n,e,t)=>(Qs(t),Zs().then(r=>{Ie=new WebSocket(r),Ie.onopen=a=>{ti(n)},Ie.onmessage=a=>{Ys(a.data,e)},Ie.onerror=async a=>{console.log("WebSocket报错，请在service work控制台查看详情"),await chrome.tabs.sendMessage(e.tab.id,{action:"configError",data:"WebSocket报错，请在service work控制台查看详情"}),console.error(`详情查看：${encodeURI(r.replace("wss:","https:"))}`)},Ie.onclose=a=>{console.log(a)}}));function ti(n){var e={header:{app_id:Un,uid:"fd3f47e4-d"},parameter:{chat:{domain:Kn}},payload:{message:{text:[...n]}}};Ie.send(JSON.stringify(e))}const ri=async(n,e)=>await ni(n,e),ni=(n,e)=>new Promise(t=>{chrome&&chrome.storage.local.get("systemSetting",r=>{let a="",s=`我复制了一段文字：${e}，我的问题是：${n}`;r.systemSetting.language==="zh"?a=Cn.find(o=>o.value===r.systemSetting.mask).prompt_zh:r.systemSetting.language==="en"&&(a=Cn.find(o=>o.value===r.systemSetting.mask).prompt_en,s=`I copied a piece of text: ${e}, my question is: ${n}`),(!e||e==="")&&(s=n),t(`${a}${s}`)})}),Cn=[{value:"common",prompt_zh:"你是一个浏览器插件，名叫ChatInBrowser，你的任务是帮助用户解答他们的问题，有时候用户会复制一段文本给你，这时候你需要根据文本内容结合用户提问来给出回答。你的回答应该尽量简短和高效。用户的输入是：",prompt_en:"You are a browser extension called ChatInBrowser. Your task is to help users answer their questions. Sometimes users will copy a piece of text to you. In such cases, you need to provide answers based on the text content combined with the user's question. Your responses should be as concise and efficient as possible. The user input is:"},{value:"translator",prompt_zh:"我想让你扮演翻译员，假如我输入一段英文，你就把它翻译成中文，要是我输入一段中文，就把它翻译成英文。有时候，我的输入中会包含我在网页中复制的文本和我的要求（格式为：我复制了一段文字：${copyValue}，我的问题是：${searchValue}），这种情况下你应该按照我的问题来翻译。你只需要输出翻译的结果。用户的输入是：",prompt_en:"I want you to play the role of a translator. If I type in an English passage, you translate it into Chinese, and if I type in a Chinese passage, you translate it into English. Sometimes my input will contain text I copied from a web page and my request (in the format: I copied a piece of text: ${copyValue}, my question is: ${searchValue}), in which case you should translate it according to my question. You only need to output the result of the translation. The user input is:"},{value:"programmer",prompt_zh:"我想让你充当 stackoverflow 的帖子。我会问与编程相关的问题，你会回答应该是什么答案。我希望你只回答给定的答案，并在不够详细的时候写解释。用户的输入是：",prompt_en:"I'd like you to act as a stackoverflow post. I will ask programming related questions and you will answer what the answer should be. I want you to answer only the given answers and write explanations when they are not detailed enough. The user input is:"},{value:"writer",prompt_zh:"我想让你充当一个作家，你的任务是根据我的要求来写作。有时候我会复制一些文字提供给你，这时候你需要在写作过程中结合我复制的这些文字。要是没有复制内容，请直接根据我的要求写作。请尽量写出高质量的文字。用户的输入是：",prompt_en:"I want you to act as a writer and your task is to write according to my requirements. Sometimes I will copy some text and provide it to you, at which point you will need to incorporate that text I have copied into your writing process. If you don't have any copied content, please write directly to my requirements. Please try to write high quality text. The user input is:"}],W0="RFC3986",L0={RFC1738:n=>String(n).replace(/%20/g,"+"),RFC3986:n=>String(n)},ai="RFC1738",si=Array.isArray,Ce=(()=>{const n=[];for(let e=0;e<256;++e)n.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return n})(),k0=1024,ii=(n,e,t,r,a)=>{if(n.length===0)return n;let s=n;if(typeof n=="symbol"?s=Symbol.prototype.toString.call(n):typeof n!="string"&&(s=String(n)),t==="iso-8859-1")return escape(s).replace(/%u[0-9a-f]{4}/gi,function(c){return"%26%23"+parseInt(c.slice(2),16)+"%3B"});let o="";for(let c=0;c<s.length;c+=k0){const v=s.length>=k0?s.slice(c,c+k0):s,i=[];for(let x=0;x<v.length;++x){let _=v.charCodeAt(x);if(_===45||_===46||_===95||_===126||_>=48&&_<=57||_>=65&&_<=90||_>=97&&_<=122||a===ai&&(_===40||_===41)){i[i.length]=v.charAt(x);continue}if(_<128){i[i.length]=Ce[_];continue}if(_<2048){i[i.length]=Ce[192|_>>6]+Ce[128|_&63];continue}if(_<55296||_>=57344){i[i.length]=Ce[224|_>>12]+Ce[128|_>>6&63]+Ce[128|_&63];continue}x+=1,_=65536+((_&1023)<<10|v.charCodeAt(x)&1023),i[i.length]=Ce[240|_>>18]+Ce[128|_>>12&63]+Ce[128|_>>6&63]+Ce[128|_&63]}o+=i.join("")}return o};function oi(n){return!n||typeof n!="object"?!1:!!(n.constructor&&n.constructor.isBuffer&&n.constructor.isBuffer(n))}function An(n,e){if(si(n)){const t=[];for(let r=0;r<n.length;r+=1)t.push(e(n[r]));return t}return e(n)}const ci=Object.prototype.hasOwnProperty,Vn={brackets(n){return String(n)+"[]"},comma:"comma",indices(n,e){return String(n)+"["+e+"]"},repeat(n){return String(n)}},Ae=Array.isArray,li=Array.prototype.push,Jn=function(n,e){li.apply(n,Ae(e)?e:[e])},xi=Date.prototype.toISOString,Z={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:ii,encodeValuesOnly:!1,format:W0,formatter:L0[W0],indices:!1,serializeDate(n){return xi.call(n)},skipNulls:!1,strictNullHandling:!1};function fi(n){return typeof n=="string"||typeof n=="number"||typeof n=="boolean"||typeof n=="symbol"||typeof n=="bigint"}const R0={};function Qn(n,e,t,r,a,s,o,c,v,i,x,_,l,u,p,g,h,B){let f=n,d=B,m=0,w=!1;for(;(d=d.get(R0))!==void 0&&!w;){const y=d.get(n);if(m+=1,typeof y<"u"){if(y===m)throw new RangeError("Cyclic object value");w=!0}typeof d.get(R0)>"u"&&(m=0)}if(typeof i=="function"?f=i(e,f):f instanceof Date?f=l==null?void 0:l(f):t==="comma"&&Ae(f)&&(f=An(f,function(y){return y instanceof Date?l==null?void 0:l(y):y})),f===null){if(s)return v&&!g?v(e,Z.encoder,h,"key",u):e;f=""}if(fi(f)||oi(f)){if(v){const y=g?e:v(e,Z.encoder,h,"key",u);return[(p==null?void 0:p(y))+"="+(p==null?void 0:p(v(f,Z.encoder,h,"value",u)))]}return[(p==null?void 0:p(e))+"="+(p==null?void 0:p(String(f)))]}const C=[];if(typeof f>"u")return C;let A;if(t==="comma"&&Ae(f))g&&v&&(f=An(f,v)),A=[{value:f.length>0?f.join(",")||null:void 0}];else if(Ae(i))A=i;else{const y=Object.keys(f);A=x?y.sort(x):y}const b=c?String(e).replace(/\./g,"%2E"):String(e),k=r&&Ae(f)&&f.length===1?b+"[]":b;if(a&&Ae(f)&&f.length===0)return k+"[]";for(let y=0;y<A.length;++y){const E=A[y],F=typeof E=="object"&&typeof E.value<"u"?E.value:f[E];if(o&&F===null)continue;const S=_&&c?E.replace(/\./g,"%2E"):E,O=Ae(f)?typeof t=="function"?t(k,S):k:k+(_?"."+S:"["+S+"]");B.set(n,m);const T=new WeakMap;T.set(R0,B),Jn(C,Qn(F,O,t,r,a,s,o,c,t==="comma"&&g&&Ae(f)?null:v,i,x,_,l,u,p,g,h,T))}return C}function ui(n=Z){if(typeof n.allowEmptyArrays<"u"&&typeof n.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof n.encodeDotInKeys<"u"&&typeof n.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(n.encoder!==null&&typeof n.encoder<"u"&&typeof n.encoder!="function")throw new TypeError("Encoder has to be a function.");const e=n.charset||Z.charset;if(typeof n.charset<"u"&&n.charset!=="utf-8"&&n.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let t=W0;if(typeof n.format<"u"){if(!ci.call(L0,n.format))throw new TypeError("Unknown format option provided.");t=n.format}const r=L0[t];let a=Z.filter;(typeof n.filter=="function"||Ae(n.filter))&&(a=n.filter);let s;if(n.arrayFormat&&n.arrayFormat in Vn?s=n.arrayFormat:"indices"in n?s=n.indices?"indices":"repeat":s=Z.arrayFormat,"commaRoundTrip"in n&&typeof n.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const o=typeof n.allowDots>"u"?n.encodeDotInKeys?!0:Z.allowDots:!!n.allowDots;return{addQueryPrefix:typeof n.addQueryPrefix=="boolean"?n.addQueryPrefix:Z.addQueryPrefix,allowDots:o,allowEmptyArrays:typeof n.allowEmptyArrays=="boolean"?!!n.allowEmptyArrays:Z.allowEmptyArrays,arrayFormat:s,charset:e,charsetSentinel:typeof n.charsetSentinel=="boolean"?n.charsetSentinel:Z.charsetSentinel,commaRoundTrip:!!n.commaRoundTrip,delimiter:typeof n.delimiter>"u"?Z.delimiter:n.delimiter,encode:typeof n.encode=="boolean"?n.encode:Z.encode,encodeDotInKeys:typeof n.encodeDotInKeys=="boolean"?n.encodeDotInKeys:Z.encodeDotInKeys,encoder:typeof n.encoder=="function"?n.encoder:Z.encoder,encodeValuesOnly:typeof n.encodeValuesOnly=="boolean"?n.encodeValuesOnly:Z.encodeValuesOnly,filter:a,format:t,formatter:r,serializeDate:typeof n.serializeDate=="function"?n.serializeDate:Z.serializeDate,skipNulls:typeof n.skipNulls=="boolean"?n.skipNulls:Z.skipNulls,sort:typeof n.sort=="function"?n.sort:null,strictNullHandling:typeof n.strictNullHandling=="boolean"?n.strictNullHandling:Z.strictNullHandling}}function di(n,e={}){let t=n;const r=ui(e);let a,s;typeof r.filter=="function"?(s=r.filter,t=s("",t)):Ae(r.filter)&&(s=r.filter,a=s);const o=[];if(typeof t!="object"||t===null)return"";const c=Vn[r.arrayFormat],v=c==="comma"&&r.commaRoundTrip;a||(a=Object.keys(t)),r.sort&&a.sort(r.sort);const i=new WeakMap;for(let l=0;l<a.length;++l){const u=a[l];r.skipNulls&&t[u]===null||Jn(o,Qn(t[u],u,c,v,r.allowEmptyArrays,r.strictNullHandling,r.skipNulls,r.encodeDotInKeys,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,i))}const x=o.join(r.delimiter);let _=r.addQueryPrefix===!0?"?":"";return r.charsetSentinel&&(r.charset==="iso-8859-1"?_+="utf8=%26%2310003%3B&":_+="utf8=%E2%9C%93&"),x.length>0?_+x:""}const ze="4.84.0";let Bn=!1,ut,Yn,Zn,z0,ea,ta,ra,na,aa;function hi(n,e={auto:!1}){if(Bn)throw new Error(`you must \`import 'openai/shims/${n.kind}'\` before importing anything else from openai`);if(ut)throw new Error(`can't \`import 'openai/shims/${n.kind}'\` after \`import 'openai/shims/${ut}'\``);Bn=e.auto,ut=n.kind,Yn=n.fetch,n.Request,n.Response,n.Headers,Zn=n.FormData,n.Blob,z0=n.File,ea=n.ReadableStream,ta=n.getMultipartRequestOptions,ra=n.getDefaultAgent,na=n.fileFromPath,aa=n.isFsReadStream}class pi{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}function mi({manuallyImported:n}={}){const e=n?"You may need to use polyfills":"Add one of these imports before your first `import … from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let t,r,a,s;try{t=fetch,r=Request,a=Response,s=Headers}catch(o){throw new Error(`this environment is missing the following Web Fetch API type: ${o.message}. ${e}`)}return{kind:"web",fetch:t,Request:r,Response:a,Headers:s,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(o,c)=>({...c,body:new pi(o)}),getDefaultAgent:o=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:o=>!1}}ut||hi(mi(),{auto:!0});class q extends Error{}class ne extends q{constructor(e,t,r,a){super(`${ne.makeMessage(e,t,r)}`),this.status=e,this.headers=a,this.request_id=a==null?void 0:a["x-request-id"],this.error=t;const s=t;this.code=s==null?void 0:s.code,this.param=s==null?void 0:s.param,this.type=s==null?void 0:s.type}static makeMessage(e,t,r){const a=t!=null&&t.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):r;return e&&a?`${e} ${a}`:e?`${e} status code (no body)`:a||"(no status code or body)"}static generate(e,t,r,a){if(!e||!a)return new Lt({message:r,cause:j0(t)});const s=t==null?void 0:t.error;return e===400?new sa(e,s,r,a):e===401?new ia(e,s,r,a):e===403?new oa(e,s,r,a):e===404?new ca(e,s,r,a):e===409?new la(e,s,r,a):e===422?new xa(e,s,r,a):e===429?new fa(e,s,r,a):e>=500?new ua(e,s,r,a):new ne(e,s,r,a)}}class _e extends ne{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class Lt extends ne{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class rr extends Lt{constructor({message:e}={}){super({message:e??"Request timed out."})}}class sa extends ne{}class ia extends ne{}class oa extends ne{}class ca extends ne{}class la extends ne{}class xa extends ne{}class fa extends ne{}class ua extends ne{}class da extends q{constructor(){super("Could not parse response content as the length limit was reached")}}class ha extends q{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}var wt=function(n,e,t,r,a){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!a:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?a.call(n,t):a?a.value=t:e.set(n,t),t},Pe=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},fe;class zt{constructor(){fe.set(this,void 0),this.buffer=new Uint8Array,wt(this,fe,null,"f")}decode(e){if(e==null)return[];const t=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?new TextEncoder().encode(e):e;let r=new Uint8Array(this.buffer.length+t.length);r.set(this.buffer),r.set(t,this.buffer.length),this.buffer=r;const a=[];let s;for(;(s=vi(this.buffer,Pe(this,fe,"f")))!=null;){if(s.carriage&&Pe(this,fe,"f")==null){wt(this,fe,s.index,"f");continue}if(Pe(this,fe,"f")!=null&&(s.index!==Pe(this,fe,"f")+1||s.carriage)){a.push(this.decodeText(this.buffer.slice(0,Pe(this,fe,"f")-1))),this.buffer=this.buffer.slice(Pe(this,fe,"f")),wt(this,fe,null,"f");continue}const o=Pe(this,fe,"f")!==null?s.preceding-1:s.preceding,c=this.decodeText(this.buffer.slice(0,o));a.push(c),this.buffer=this.buffer.slice(s.index),wt(this,fe,null,"f")}return a}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new q(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new q(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new q("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){return this.buffer.length?this.decode(`
`):[]}}fe=new WeakMap;zt.NEWLINE_CHARS=new Set([`
`,"\r"]);zt.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function vi(n,e){for(let a=e??0;a<n.length;a++){if(n[a]===10)return{preceding:a,index:a+1,carriage:!1};if(n[a]===13)return{preceding:a,index:a+1,carriage:!0}}return null}function pa(n){if(n[Symbol.asyncIterator])return n;const e=n.getReader();return{async next(){try{const t=await e.read();return t!=null&&t.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}class we{constructor(e,t){this.iterator=e,this.controller=t}static fromSSEResponse(e,t){let r=!1;async function*a(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let s=!1;try{for await(const o of _i(e,t))if(!s){if(o.data.startsWith("[DONE]")){s=!0;continue}if(o.event===null){let c;try{c=JSON.parse(o.data)}catch(v){throw console.error("Could not parse message into JSON:",o.data),console.error("From chunk:",o.raw),v}if(c&&c.error)throw new ne(void 0,c.error,void 0,void 0);yield c}else{let c;try{c=JSON.parse(o.data)}catch(v){throw console.error("Could not parse message into JSON:",o.data),console.error("From chunk:",o.raw),v}if(o.event=="error")throw new ne(void 0,c.error,c.message,void 0);yield{event:o.event,data:c}}}s=!0}catch(o){if(o instanceof Error&&o.name==="AbortError")return;throw o}finally{s||t.abort()}}return new we(a,t)}static fromReadableStream(e,t){let r=!1;async function*a(){const o=new zt,c=pa(e);for await(const v of c)for(const i of o.decode(v))yield i;for(const v of o.flush())yield v}async function*s(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let o=!1;try{for await(const c of a())o||c&&(yield JSON.parse(c));o=!0}catch(c){if(c instanceof Error&&c.name==="AbortError")return;throw c}finally{o||t.abort()}}return new we(s,t)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],r=this.iterator(),a=s=>({next:()=>{if(s.length===0){const o=r.next();e.push(o),t.push(o)}return s.shift()}});return[new we(()=>a(e),this.controller),new we(()=>a(t),this.controller)]}toReadableStream(){const e=this;let t;const r=new TextEncoder;return new ea({async start(){t=e[Symbol.asyncIterator]()},async pull(a){try{const{value:s,done:o}=await t.next();if(o)return a.close();const c=r.encode(JSON.stringify(s)+`
`);a.enqueue(c)}catch(s){a.error(s)}},async cancel(){var a;await((a=t.return)==null?void 0:a.call(t))}})}}async function*_i(n,e){if(!n.body)throw e.abort(),new q("Attempted to iterate over a response with no body");const t=new Ci,r=new zt,a=pa(n.body);for await(const s of gi(a))for(const o of r.decode(s)){const c=t.decode(o);c&&(yield c)}for(const s of r.flush()){const o=t.decode(s);o&&(yield o)}}async function*gi(n){let e=new Uint8Array;for await(const t of n){if(t==null)continue;const r=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?new TextEncoder().encode(t):t;let a=new Uint8Array(e.length+r.length);a.set(e),a.set(r,e.length),e=a;let s;for(;(s=yi(e))!==-1;)yield e.slice(0,s),e=e.slice(s)}e.length>0&&(yield e)}function yi(n){for(let r=0;r<n.length-2;r++){if(n[r]===10&&n[r+1]===10||n[r]===13&&n[r+1]===13)return r+2;if(n[r]===13&&n[r+1]===10&&r+3<n.length&&n[r+2]===13&&n[r+3]===10)return r+4}return-1}class Ci{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const s={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],s}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,r,a]=Ai(e,":");return a.startsWith(" ")&&(a=a.substring(1)),t==="event"?this.event=a:t==="data"&&this.data.push(a),null}}function Ai(n,e){const t=n.indexOf(e);return t!==-1?[n.substring(0,t),e,n.substring(t+e.length)]:[n,"",""]}const ma=n=>n!=null&&typeof n=="object"&&typeof n.url=="string"&&typeof n.blob=="function",va=n=>n!=null&&typeof n=="object"&&typeof n.name=="string"&&typeof n.lastModified=="number"&&Ut(n),Ut=n=>n!=null&&typeof n=="object"&&typeof n.size=="number"&&typeof n.type=="string"&&typeof n.text=="function"&&typeof n.slice=="function"&&typeof n.arrayBuffer=="function",Bi=n=>va(n)||ma(n)||aa(n);async function _a(n,e,t){var a;if(n=await n,va(n))return n;if(ma(n)){const s=await n.blob();e||(e=new URL(n.url).pathname.split(/[\\/]/).pop()??"unknown_file");const o=Ut(s)?[await s.arrayBuffer()]:[s];return new z0(o,e,t)}const r=await wi(n);if(e||(e=bi(n)??"unknown_file"),!(t!=null&&t.type)){const s=(a=r[0])==null?void 0:a.type;typeof s=="string"&&(t={...t,type:s})}return new z0(r,e,t)}async function wi(n){var t;let e=[];if(typeof n=="string"||ArrayBuffer.isView(n)||n instanceof ArrayBuffer)e.push(n);else if(Ut(n))e.push(await n.arrayBuffer());else if(Fi(n))for await(const r of n)e.push(r);else throw new Error(`Unexpected data type: ${typeof n}; constructor: ${(t=n==null?void 0:n.constructor)==null?void 0:t.name}; props: ${Ei(n)}`);return e}function Ei(n){return`[${Object.getOwnPropertyNames(n).map(t=>`"${t}"`).join(", ")}]`}function bi(n){var e;return P0(n.name)||P0(n.filename)||((e=P0(n.path))==null?void 0:e.split(/[\\/]/).pop())}const P0=n=>{if(typeof n=="string")return n;if(typeof Buffer<"u"&&n instanceof Buffer)return String(n)},Fi=n=>n!=null&&typeof n=="object"&&typeof n[Symbol.asyncIterator]=="function",wn=n=>n&&typeof n=="object"&&n.body&&n[Symbol.toStringTag]==="MultipartBody",Ve=async n=>{const e=await Di(n.body);return ta(e,n)},Di=async n=>{const e=new Zn;return await Promise.all(Object.entries(n||{}).map(([t,r])=>U0(e,t,r))),e},U0=async(n,e,t)=>{if(t!==void 0){if(t==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof t=="string"||typeof t=="number"||typeof t=="boolean")n.append(e,String(t));else if(Bi(t)){const r=await _a(t);n.append(e,r)}else if(Array.isArray(t))await Promise.all(t.map(r=>U0(n,e+"[]",r)));else if(typeof t=="object")await Promise.all(Object.entries(t).map(([r,a])=>U0(n,`${e}[${r}]`,a)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${t} instead`)}};var Si=function(n,e,t,r,a){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!a:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?a.call(n,t):a?a.value=t:e.set(n,t),t},ki=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},Et;async function ga(n){const{response:e}=n;if(n.options.stream)return Xe("response",e.status,e.url,e.headers,e.body),n.options.__streamClass?n.options.__streamClass.fromSSEResponse(e,n.controller):we.fromSSEResponse(e,n.controller);if(e.status===204)return null;if(n.options.__binaryResponse)return e;const t=e.headers.get("content-type");if((t==null?void 0:t.includes("application/json"))||(t==null?void 0:t.includes("application/vnd.api+json"))){const s=await e.json();return Xe("response",e.status,e.url,e.headers,s),ya(s,e)}const a=await e.text();return Xe("response",e.status,e.url,e.headers,a),a}function ya(n,e){return!n||typeof n!="object"||Array.isArray(n)?n:Object.defineProperty(n,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}class jt extends Promise{constructor(e,t=ga){super(r=>{r(null)}),this.responsePromise=e,this.parseResponse=t}_thenUnwrap(e){return new jt(this.responsePromise,async t=>ya(e(await this.parseResponse(t),t),t.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class Ri{constructor({baseURL:e,maxRetries:t=2,timeout:r=6e5,httpAgent:a,fetch:s}){this.baseURL=e,this.maxRetries=I0("maxRetries",t),this.timeout=I0("timeout",r),this.httpAgent=a,this.fetch=s??Yn}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...Hi(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${Wi()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,r){return this.request(Promise.resolve(r).then(async a=>{const s=a&&Ut(a==null?void 0:a.body)?new DataView(await a.body.arrayBuffer()):(a==null?void 0:a.body)instanceof DataView?a.body:(a==null?void 0:a.body)instanceof ArrayBuffer?new DataView(a.body):a&&ArrayBuffer.isView(a==null?void 0:a.body)?new DataView(a.body.buffer):a==null?void 0:a.body;return{method:e,path:t,...a,body:s}}))}getAPIList(e,t,r){return this.requestAPIList(t,{method:"get",path:e,...r})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:t=0}={}){var p;e={...e};const{method:r,path:a,query:s,headers:o={}}=e,c=ArrayBuffer.isView(e.body)||e.__binaryRequest&&typeof e.body=="string"?e.body:wn(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,v=this.calculateContentLength(c),i=this.buildURL(a,s);"timeout"in e&&I0("timeout",e.timeout),e.timeout=e.timeout??this.timeout;const x=e.httpAgent??this.httpAgent??ra(i),_=e.timeout+1e3;typeof((p=x==null?void 0:x.options)==null?void 0:p.timeout)=="number"&&_>(x.options.timeout??0)&&(x.options.timeout=_),this.idempotencyHeader&&r!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),o[this.idempotencyHeader]=e.idempotencyKey);const l=this.buildHeaders({options:e,headers:o,contentLength:v,retryCount:t});return{req:{method:r,...c&&{body:c},headers:l,...x&&{agent:x},signal:e.signal??null},url:i,timeout:e.timeout}}buildHeaders({options:e,headers:t,contentLength:r,retryCount:a}){const s={};r&&(s["content-length"]=r);const o=this.defaultHeaders(e);return Dn(s,o),Dn(s,t),wn(e.body)&&ut!=="node"&&delete s["content-type"],Ft(o,"x-stainless-retry-count")===void 0&&Ft(t,"x-stainless-retry-count")===void 0&&(s["x-stainless-retry-count"]=String(a)),Ft(o,"x-stainless-timeout")===void 0&&Ft(t,"x-stainless-timeout")===void 0&&e.timeout&&(s["x-stainless-timeout"]=String(e.timeout)),this.validateHeaders(s,t),s}async prepareOptions(e){}async prepareRequest(e,{url:t,options:r}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(t=>[...t])):{...e}:{}}makeStatusError(e,t,r,a){return ne.generate(e,t,r,a)}request(e,t=null){return new jt(this.makeRequest(e,t))}async makeRequest(e,t){var _,l;const r=await e,a=r.maxRetries??this.maxRetries;t==null&&(t=a),await this.prepareOptions(r);const{req:s,url:o,timeout:c}=this.buildRequest(r,{retryCount:a-t});if(await this.prepareRequest(s,{url:o,options:r}),Xe("request",o,r,s.headers),(_=r.signal)!=null&&_.aborted)throw new _e;const v=new AbortController,i=await this.fetchWithTimeout(o,s,c,v).catch(j0);if(i instanceof Error){if((l=r.signal)!=null&&l.aborted)throw new _e;if(t)return this.retryRequest(r,t);throw i.name==="AbortError"?new rr:new Lt({cause:i})}const x=Ii(i.headers);if(!i.ok){if(t&&this.shouldRetry(i)){const f=`retrying, ${t} attempts remaining`;return Xe(`response (error; ${f})`,i.status,o,x),this.retryRequest(r,t,x)}const u=await i.text().catch(f=>j0(f).message),p=Mi(u),g=p?void 0:u;throw Xe(`response (error; ${t?"(error; no more retries left)":"(error; not retryable)"})`,i.status,o,x,g),this.makeStatusError(i.status,p,g,x)}return{response:i,options:r,controller:v}}requestAPIList(e,t){const r=this.makeRequest(t,null);return new Pi(this,r,e)}buildURL(e,t){const r=qi(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),a=this.defaultQuery();return Aa(a)||(t={...a,...t}),typeof t=="object"&&t&&!Array.isArray(t)&&(r.search=this.stringifyQuery(t)),r.toString()}stringifyQuery(e){return Object.entries(e).filter(([t,r])=>typeof r<"u").map(([t,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(t)}=`;throw new q(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,t,r,a){const{signal:s,...o}=t||{};s&&s.addEventListener("abort",()=>a.abort());const c=setTimeout(()=>a.abort(),r),v={signal:a.signal,...o};return v.method&&(v.method=v.method.toUpperCase()),this.fetch.call(void 0,e,v).finally(()=>{clearTimeout(c)})}shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,r){let a;const s=r==null?void 0:r["retry-after-ms"];if(s){const c=parseFloat(s);Number.isNaN(c)||(a=c)}const o=r==null?void 0:r["retry-after"];if(o&&!a){const c=parseFloat(o);Number.isNaN(c)?a=Date.parse(o)-Date.now():a=c*1e3}if(!(a&&0<=a&&a<60*1e3)){const c=e.maxRetries??this.maxRetries;a=this.calculateDefaultRetryTimeoutMillis(t,c)}return await mt(a),this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){const s=t-e,o=Math.min(.5*Math.pow(2,s),8),c=1-Math.random()*.25;return o*c*1e3}getUserAgent(){return`${this.constructor.name}/JS ${ze}`}}class Ca{constructor(e,t,r,a){Et.set(this,void 0),Si(this,Et,e,"f"),this.options=a,this.response=t,this.body=r}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new q("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const t={...this.options};if("params"in e&&typeof t.query=="object")t.query={...t.query,...e.params};else if("url"in e){const r=[...Object.entries(t.query||{}),...e.url.searchParams.entries()];for(const[a,s]of r)e.url.searchParams.set(a,s);t.query=void 0,t.path=e.url.toString()}return await ki(this,Et,"f").requestAPIList(this.constructor,t)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(Et=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const t of e.getPaginatedItems())yield t}}class Pi extends jt{constructor(e,t,r){super(t,async a=>new r(e,a.response,await ga(a),a.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const t of e)yield t}}const Ii=n=>new Proxy(Object.fromEntries(n.entries()),{get(e,t){const r=t.toString();return e[r.toLowerCase()]||e[r]}}),Oi={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__metadata:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},oe=n=>typeof n=="object"&&n!==null&&!Aa(n)&&Object.keys(n).every(e=>Ba(Oi,e)),$i=()=>{var e;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ze,"X-Stainless-OS":bn(Deno.build.os),"X-Stainless-Arch":En(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((e=Deno.version)==null?void 0:e.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ze,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ze,"X-Stainless-OS":bn(process.platform),"X-Stainless-Arch":En(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const n=Ti();return n?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ze,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${n.browser}`,"X-Stainless-Runtime-Version":n.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ze,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function Ti(){if(typeof navigator>"u"||!navigator)return null;const n=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of n){const r=t.exec(navigator.userAgent);if(r){const a=r[1]||0,s=r[2]||0,o=r[3]||0;return{browser:e,version:`${a}.${s}.${o}`}}}return null}const En=n=>n==="x32"?"x32":n==="x86_64"||n==="x64"?"x64":n==="arm"?"arm":n==="aarch64"||n==="arm64"?"arm64":n?`other:${n}`:"unknown",bn=n=>(n=n.toLowerCase(),n.includes("ios")?"iOS":n==="android"?"Android":n==="darwin"?"MacOS":n==="win32"?"Windows":n==="freebsd"?"FreeBSD":n==="openbsd"?"OpenBSD":n==="linux"?"Linux":n?`Other:${n}`:"Unknown");let Fn;const Hi=()=>Fn??(Fn=$i()),Mi=n=>{try{return JSON.parse(n)}catch{return}},Ni=/^[a-z][a-z0-9+.-]*:/i,qi=n=>Ni.test(n),mt=n=>new Promise(e=>setTimeout(e,n)),I0=(n,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new q(`${n} must be an integer`);if(e<0)throw new q(`${n} must be a positive integer`);return e},j0=n=>{if(n instanceof Error)return n;if(typeof n=="object"&&n!==null)try{return new Error(JSON.stringify(n))}catch{}return new Error(n)},bt=n=>{var e,t,r,a,s;if(typeof process<"u")return((t=(e=process.env)==null?void 0:e[n])==null?void 0:t.trim())??void 0;if(typeof Deno<"u")return(s=(a=(r=Deno.env)==null?void 0:r.get)==null?void 0:a.call(r,n))==null?void 0:s.trim()};function Aa(n){if(!n)return!0;for(const e in n)return!1;return!0}function Ba(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Dn(n,e){for(const t in e){if(!Ba(e,t))continue;const r=t.toLowerCase();if(!r)continue;const a=e[t];a===null?delete n[r]:a!==void 0&&(n[r]=a)}}const Sn=new Set(["authorization","api-key"]);function Xe(n,...e){var t;if(typeof process<"u"&&((t=process==null?void 0:process.env)==null?void 0:t.DEBUG)==="true"){const r=e.map(a=>{if(!a)return a;if(a.headers){const o={...a,headers:{...a.headers}};for(const c in a.headers)Sn.has(c.toLowerCase())&&(o.headers[c]="REDACTED");return o}let s=null;for(const o in a)Sn.has(o.toLowerCase())&&(s??(s={...a}),s[o]="REDACTED");return s??a});console.log(`OpenAI:DEBUG:${n}`,...r)}}const Wi=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,n=>{const e=Math.random()*16|0;return(n==="x"?e:e&3|8).toString(16)}),Li=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",zi=n=>typeof(n==null?void 0:n.get)=="function",Ft=(n,e)=>{var r;const t=e.toLowerCase();if(zi(n)){const a=((r=e[0])==null?void 0:r.toUpperCase())+e.substring(1).replace(/([^\w])(\w)/g,(s,o,c)=>o+c.toUpperCase());for(const s of[e,t,e.toUpperCase(),a]){const o=n.get(s);if(o)return o}}for(const[a,s]of Object.entries(n))if(a.toLowerCase()===t)return Array.isArray(s)?(s.length<=1||console.warn(`Received ${s.length} entries for the ${e} header, using the first entry.`),s[0]):s};function O0(n){return n!=null&&typeof n=="object"&&!Array.isArray(n)}class Ui extends Ca{constructor(e,t,r,a){super(e,t,r,a),this.data=r.data||[],this.object=r.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class ye extends Ca{constructor(e,t,r,a){super(e,t,r,a),this.data=r.data||[],this.has_more=r.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const t=Object.fromEntries(e.url.searchParams);return Object.keys(t).length?t:null}nextPageInfo(){var r;const e=this.getPaginatedItems();if(!e.length)return null;const t=(r=e[e.length-1])==null?void 0:r.id;return t?{params:{after:t}}:null}}class z{constructor(e){this._client=e}}let wa=class extends z{create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}},nr=class extends z{constructor(){super(...arguments),this.completions=new wa(this._client)}};nr.Completions=wa;class Ea extends z{create(e,t){return this._client.post("/audio/speech",{body:e,...t,headers:{Accept:"application/octet-stream",...t==null?void 0:t.headers},__binaryResponse:!0})}}class ba extends z{create(e,t){return this._client.post("/audio/transcriptions",Ve({body:e,...t,__metadata:{model:e.model}}))}}class Fa extends z{create(e,t){return this._client.post("/audio/translations",Ve({body:e,...t,__metadata:{model:e.model}}))}}class vt extends z{constructor(){super(...arguments),this.transcriptions=new ba(this._client),this.translations=new Fa(this._client),this.speech=new Ea(this._client)}}vt.Transcriptions=ba;vt.Translations=Fa;vt.Speech=Ea;class ar extends z{create(e,t){return this._client.post("/batches",{body:e,...t})}retrieve(e,t){return this._client.get(`/batches/${e}`,t)}list(e={},t){return oe(e)?this.list({},e):this._client.getAPIList("/batches",sr,{query:e,...t})}cancel(e,t){return this._client.post(`/batches/${e}/cancel`,t)}}class sr extends ye{}ar.BatchesPage=sr;class ir extends z{create(e,t){return this._client.post("/assistants",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(e,t,r){return this._client.post(`/assistants/${e}`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e={},t){return oe(e)?this.list({},e):this._client.getAPIList("/assistants",or,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}del(e,t){return this._client.delete(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class or extends ye{}ir.AssistantsPage=or;function kn(n){return typeof n.parse=="function"}const Ke=n=>(n==null?void 0:n.role)==="assistant",Da=n=>(n==null?void 0:n.role)==="function",Sa=n=>(n==null?void 0:n.role)==="tool";var me=function(n,e,t,r,a){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!a:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?a.call(n,t):a?a.value=t:e.set(n,t),t},Q=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},X0,Rt,Pt,it,ot,It,ct,be,lt,Ht,Mt,Ue,ka;class Ra{constructor(){X0.add(this),this.controller=new AbortController,Rt.set(this,void 0),Pt.set(this,()=>{}),it.set(this,()=>{}),ot.set(this,void 0),It.set(this,()=>{}),ct.set(this,()=>{}),be.set(this,{}),lt.set(this,!1),Ht.set(this,!1),Mt.set(this,!1),Ue.set(this,!1),me(this,Rt,new Promise((e,t)=>{me(this,Pt,e,"f"),me(this,it,t,"f")}),"f"),me(this,ot,new Promise((e,t)=>{me(this,It,e,"f"),me(this,ct,t,"f")}),"f"),Q(this,Rt,"f").catch(()=>{}),Q(this,ot,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},Q(this,X0,"m",ka).bind(this))},0)}_connected(){this.ended||(Q(this,Pt,"f").call(this),this._emit("connect"))}get ended(){return Q(this,lt,"f")}get errored(){return Q(this,Ht,"f")}get aborted(){return Q(this,Mt,"f")}abort(){this.controller.abort()}on(e,t){return(Q(this,be,"f")[e]||(Q(this,be,"f")[e]=[])).push({listener:t}),this}off(e,t){const r=Q(this,be,"f")[e];if(!r)return this;const a=r.findIndex(s=>s.listener===t);return a>=0&&r.splice(a,1),this}once(e,t){return(Q(this,be,"f")[e]||(Q(this,be,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,r)=>{me(this,Ue,!0,"f"),e!=="error"&&this.once("error",r),this.once(e,t)})}async done(){me(this,Ue,!0,"f"),await Q(this,ot,"f")}_emit(e,...t){if(Q(this,lt,"f"))return;e==="end"&&(me(this,lt,!0,"f"),Q(this,It,"f").call(this));const r=Q(this,be,"f")[e];if(r&&(Q(this,be,"f")[e]=r.filter(a=>!a.once),r.forEach(({listener:a})=>a(...t))),e==="abort"){const a=t[0];!Q(this,Ue,"f")&&!(r!=null&&r.length)&&Promise.reject(a),Q(this,it,"f").call(this,a),Q(this,ct,"f").call(this,a),this._emit("end");return}if(e==="error"){const a=t[0];!Q(this,Ue,"f")&&!(r!=null&&r.length)&&Promise.reject(a),Q(this,it,"f").call(this,a),Q(this,ct,"f").call(this,a),this._emit("end")}}_emitFinal(){}}Rt=new WeakMap,Pt=new WeakMap,it=new WeakMap,ot=new WeakMap,It=new WeakMap,ct=new WeakMap,be=new WeakMap,lt=new WeakMap,Ht=new WeakMap,Mt=new WeakMap,Ue=new WeakMap,X0=new WeakSet,ka=function(e){if(me(this,Ht,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new _e),e instanceof _e)return me(this,Mt,!0,"f"),this._emit("abort",e);if(e instanceof q)return this._emit("error",e);if(e instanceof Error){const t=new q(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new q(String(e)))};function Pa(n){return(n==null?void 0:n.$brand)==="auto-parseable-response-format"}function _t(n){return(n==null?void 0:n.$brand)==="auto-parseable-tool"}function ji(n,e){return!e||!Ia(e)?{...n,choices:n.choices.map(t=>({...t,message:{...t.message,parsed:null,tool_calls:t.message.tool_calls??[]}}))}:cr(n,e)}function cr(n,e){const t=n.choices.map(r=>{var a;if(r.finish_reason==="length")throw new da;if(r.finish_reason==="content_filter")throw new ha;return{...r,message:{...r.message,tool_calls:((a=r.message.tool_calls)==null?void 0:a.map(s=>Ki(e,s)))??[],parsed:r.message.content&&!r.message.refusal?Xi(e,r.message.content):null}}});return{...n,choices:t}}function Xi(n,e){var t,r;return((t=n.response_format)==null?void 0:t.type)!=="json_schema"?null:((r=n.response_format)==null?void 0:r.type)==="json_schema"?"$parseRaw"in n.response_format?n.response_format.$parseRaw(e):JSON.parse(e):null}function Ki(n,e){var r;const t=(r=n.tools)==null?void 0:r.find(a=>{var s;return((s=a.function)==null?void 0:s.name)===e.function.name});return{...e,function:{...e.function,parsed_arguments:_t(t)?t.$parseRaw(e.function.arguments):t!=null&&t.function.strict?JSON.parse(e.function.arguments):null}}}function Gi(n,e){var r;if(!n)return!1;const t=(r=n.tools)==null?void 0:r.find(a=>{var s;return((s=a.function)==null?void 0:s.name)===e.function.name});return _t(t)||(t==null?void 0:t.function.strict)||!1}function Ia(n){var e;return Pa(n.response_format)?!0:((e=n.tools)==null?void 0:e.some(t=>_t(t)||t.type==="function"&&t.function.strict===!0))??!1}function Vi(n){for(const e of n??[]){if(e.type!=="function")throw new q(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new q(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var ie=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},ae,K0,Nt,G0,V0,J0,Oa,Q0;const Rn=10;class $a extends Ra{constructor(){super(...arguments),ae.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){var r;this._chatCompletions.push(e),this._emit("chatCompletion",e);const t=(r=e.choices[0])==null?void 0:r.message;return t&&this._addMessage(t),e}_addMessage(e,t=!0){if("content"in e||(e.content=null),this.messages.push(e),t){if(this._emit("message",e),(Da(e)||Sa(e))&&e.content)this._emit("functionCallResult",e.content);else if(Ke(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(Ke(e)&&e.tool_calls)for(const r of e.tool_calls)r.type==="function"&&this._emit("functionCall",r.function)}}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new q("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),ie(this,ae,"m",K0).call(this)}async finalMessage(){return await this.done(),ie(this,ae,"m",Nt).call(this)}async finalFunctionCall(){return await this.done(),ie(this,ae,"m",G0).call(this)}async finalFunctionCallResult(){return await this.done(),ie(this,ae,"m",V0).call(this)}async totalUsage(){return await this.done(),ie(this,ae,"m",J0).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const t=ie(this,ae,"m",Nt).call(this);t&&this._emit("finalMessage",t);const r=ie(this,ae,"m",K0).call(this);r&&this._emit("finalContent",r);const a=ie(this,ae,"m",G0).call(this);a&&this._emit("finalFunctionCall",a);const s=ie(this,ae,"m",V0).call(this);s!=null&&this._emit("finalFunctionCallResult",s),this._chatCompletions.some(o=>o.usage)&&this._emit("totalUsage",ie(this,ae,"m",J0).call(this))}async _createChatCompletion(e,t,r){const a=r==null?void 0:r.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),ie(this,ae,"m",Oa).call(this,t);const s=await e.chat.completions.create({...t,stream:!1},{...r,signal:this.controller.signal});return this._connected(),this._addChatCompletion(cr(s,t))}async _runChatCompletion(e,t,r){for(const a of t.messages)this._addMessage(a,!1);return await this._createChatCompletion(e,t,r)}async _runFunctions(e,t,r){var l;const a="function",{function_call:s="auto",stream:o,...c}=t,v=typeof s!="string"&&(s==null?void 0:s.name),{maxChatCompletions:i=Rn}=r||{},x={};for(const u of t.functions)x[u.name||u.function.name]=u;const _=t.functions.map(u=>({name:u.name||u.function.name,parameters:u.parameters,description:u.description}));for(const u of t.messages)this._addMessage(u,!1);for(let u=0;u<i;++u){const g=(l=(await this._createChatCompletion(e,{...c,function_call:s,functions:_,messages:[...this.messages]},r)).choices[0])==null?void 0:l.message;if(!g)throw new q("missing message in ChatCompletion response");if(!g.function_call)return;const{name:h,arguments:B}=g.function_call,f=x[h];if(f){if(v&&v!==h){const C=`Invalid function_call: ${JSON.stringify(h)}. ${JSON.stringify(v)} requested. Please try again`;this._addMessage({role:a,name:h,content:C});continue}}else{const C=`Invalid function_call: ${JSON.stringify(h)}. Available options are: ${_.map(A=>JSON.stringify(A.name)).join(", ")}. Please try again`;this._addMessage({role:a,name:h,content:C});continue}let d;try{d=kn(f)?await f.parse(B):B}catch(C){this._addMessage({role:a,name:h,content:C instanceof Error?C.message:String(C)});continue}const m=await f.function(d,this),w=ie(this,ae,"m",Q0).call(this,m);if(this._addMessage({role:a,name:h,content:w}),v)return}}async _runTools(e,t,r){var u,p,g;const a="tool",{tool_choice:s="auto",stream:o,...c}=t,v=typeof s!="string"&&((u=s==null?void 0:s.function)==null?void 0:u.name),{maxChatCompletions:i=Rn}=r||{},x=t.tools.map(h=>{if(_t(h)){if(!h.$callback)throw new q("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:h.$callback,name:h.function.name,description:h.function.description||"",parameters:h.function.parameters,parse:h.$parseRaw,strict:!0}}}return h}),_={};for(const h of x)h.type==="function"&&(_[h.function.name||h.function.function.name]=h.function);const l="tools"in t?x.map(h=>h.type==="function"?{type:"function",function:{name:h.function.name||h.function.function.name,parameters:h.function.parameters,description:h.function.description,strict:h.function.strict}}:h):void 0;for(const h of t.messages)this._addMessage(h,!1);for(let h=0;h<i;++h){const f=(p=(await this._createChatCompletion(e,{...c,tool_choice:s,tools:l,messages:[...this.messages]},r)).choices[0])==null?void 0:p.message;if(!f)throw new q("missing message in ChatCompletion response");if(!((g=f.tool_calls)!=null&&g.length))return;for(const d of f.tool_calls){if(d.type!=="function")continue;const m=d.id,{name:w,arguments:C}=d.function,A=_[w];if(A){if(v&&v!==w){const E=`Invalid tool_call: ${JSON.stringify(w)}. ${JSON.stringify(v)} requested. Please try again`;this._addMessage({role:a,tool_call_id:m,content:E});continue}}else{const E=`Invalid tool_call: ${JSON.stringify(w)}. Available options are: ${Object.keys(_).map(F=>JSON.stringify(F)).join(", ")}. Please try again`;this._addMessage({role:a,tool_call_id:m,content:E});continue}let b;try{b=kn(A)?await A.parse(C):C}catch(E){const F=E instanceof Error?E.message:String(E);this._addMessage({role:a,tool_call_id:m,content:F});continue}const k=await A.function(b,this),y=ie(this,ae,"m",Q0).call(this,k);if(this._addMessage({role:a,tool_call_id:m,content:y}),v)return}}}}ae=new WeakSet,K0=function(){return ie(this,ae,"m",Nt).call(this).content??null},Nt=function(){let e=this.messages.length;for(;e-- >0;){const t=this.messages[e];if(Ke(t)){const{function_call:r,...a}=t,s={...a,content:t.content??null,refusal:t.refusal??null};return r&&(s.function_call=r),s}}throw new q("stream ended without producing a ChatCompletionMessage with role=assistant")},G0=function(){var e,t;for(let r=this.messages.length-1;r>=0;r--){const a=this.messages[r];if(Ke(a)&&(a!=null&&a.function_call))return a.function_call;if(Ke(a)&&((e=a==null?void 0:a.tool_calls)!=null&&e.length))return(t=a.tool_calls.at(-1))==null?void 0:t.function}},V0=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(Da(t)&&t.content!=null||Sa(t)&&t.content!=null&&typeof t.content=="string"&&this.messages.some(r=>{var a;return r.role==="assistant"&&((a=r.tool_calls)==null?void 0:a.some(s=>s.type==="function"&&s.id===t.tool_call_id))}))return t.content}},J0=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},Oa=function(e){if(e.n!=null&&e.n>1)throw new q("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},Q0=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class ht extends $a{static runFunctions(e,t,r){const a=new ht,s={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return a._run(()=>a._runFunctions(e,t,s)),a}static runTools(e,t,r){const a=new ht,s={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return a._run(()=>a._runTools(e,t,s)),a}_addMessage(e,t=!0){super._addMessage(e,t),Ke(e)&&e.content&&this._emit("content",e.content)}}const Ta=1,Ha=2,Ma=4,Na=8,qa=16,Wa=32,La=64,za=128,Ua=256,ja=za|Ua,Xa=qa|Wa|ja|La,Ka=Ta|Ha|Xa,Ga=Ma|Na,Ji=Ka|Ga,ee={STR:Ta,NUM:Ha,ARR:Ma,OBJ:Na,NULL:qa,BOOL:Wa,NAN:La,INFINITY:za,MINUS_INFINITY:Ua,INF:ja,SPECIAL:Xa,ATOM:Ka,COLLECTION:Ga,ALL:Ji};class Qi extends Error{}class Yi extends Error{}function Zi(n,e=ee.ALL){if(typeof n!="string")throw new TypeError(`expecting str, got ${typeof n}`);if(!n.trim())throw new Error(`${n} is empty`);return eo(n.trim(),e)}const eo=(n,e)=>{const t=n.length;let r=0;const a=l=>{throw new Qi(`${l} at position ${r}`)},s=l=>{throw new Yi(`${l} at position ${r}`)},o=()=>(_(),r>=t&&a("Unexpected end of input"),n[r]==='"'?c():n[r]==="{"?v():n[r]==="["?i():n.substring(r,r+4)==="null"||ee.NULL&e&&t-r<4&&"null".startsWith(n.substring(r))?(r+=4,null):n.substring(r,r+4)==="true"||ee.BOOL&e&&t-r<4&&"true".startsWith(n.substring(r))?(r+=4,!0):n.substring(r,r+5)==="false"||ee.BOOL&e&&t-r<5&&"false".startsWith(n.substring(r))?(r+=5,!1):n.substring(r,r+8)==="Infinity"||ee.INFINITY&e&&t-r<8&&"Infinity".startsWith(n.substring(r))?(r+=8,1/0):n.substring(r,r+9)==="-Infinity"||ee.MINUS_INFINITY&e&&1<t-r&&t-r<9&&"-Infinity".startsWith(n.substring(r))?(r+=9,-1/0):n.substring(r,r+3)==="NaN"||ee.NAN&e&&t-r<3&&"NaN".startsWith(n.substring(r))?(r+=3,NaN):x()),c=()=>{const l=r;let u=!1;for(r++;r<t&&(n[r]!=='"'||u&&n[r-1]==="\\");)u=n[r]==="\\"?!u:!1,r++;if(n.charAt(r)=='"')try{return JSON.parse(n.substring(l,++r-Number(u)))}catch(p){s(String(p))}else if(ee.STR&e)try{return JSON.parse(n.substring(l,r-Number(u))+'"')}catch{return JSON.parse(n.substring(l,n.lastIndexOf("\\"))+'"')}a("Unterminated string literal")},v=()=>{r++,_();const l={};try{for(;n[r]!=="}";){if(_(),r>=t&&ee.OBJ&e)return l;const u=c();_(),r++;try{const p=o();Object.defineProperty(l,u,{value:p,writable:!0,enumerable:!0,configurable:!0})}catch(p){if(ee.OBJ&e)return l;throw p}_(),n[r]===","&&r++}}catch{if(ee.OBJ&e)return l;a("Expected '}' at end of object")}return r++,l},i=()=>{r++;const l=[];try{for(;n[r]!=="]";)l.push(o()),_(),n[r]===","&&r++}catch{if(ee.ARR&e)return l;a("Expected ']' at end of array")}return r++,l},x=()=>{if(r===0){n==="-"&&ee.NUM&e&&a("Not sure what '-' is");try{return JSON.parse(n)}catch(u){if(ee.NUM&e)try{return n[n.length-1]==="."?JSON.parse(n.substring(0,n.lastIndexOf("."))):JSON.parse(n.substring(0,n.lastIndexOf("e")))}catch{}s(String(u))}}const l=r;for(n[r]==="-"&&r++;n[r]&&!",]}".includes(n[r]);)r++;r==t&&!(ee.NUM&e)&&a("Unterminated number literal");try{return JSON.parse(n.substring(l,r))}catch{n.substring(l,r)==="-"&&ee.NUM&e&&a("Not sure what '-' is");try{return JSON.parse(n.substring(l,n.lastIndexOf("e")))}catch(p){s(String(p))}}},_=()=>{for(;r<t&&` 
\r	`.includes(n[r]);)r++};return o()},Pn=n=>Zi(n,ee.ALL^ee.NUM);var We=function(n,e,t,r,a){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!a:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?a.call(n,t):a?a.value=t:e.set(n,t),t},X=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},Y,Ee,Le,Se,$0,Dt,T0,H0,M0,St,N0,In;class pt extends $a{constructor(e){super(),Y.add(this),Ee.set(this,void 0),Le.set(this,void 0),Se.set(this,void 0),We(this,Ee,e,"f"),We(this,Le,[],"f")}get currentChatCompletionSnapshot(){return X(this,Se,"f")}static fromReadableStream(e){const t=new pt(null);return t._run(()=>t._fromReadableStream(e)),t}static createChatCompletion(e,t,r){const a=new pt(t);return a._run(()=>a._runChatCompletion(e,{...t,stream:!0},{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createChatCompletion(e,t,r){var o;super._createChatCompletion;const a=r==null?void 0:r.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),X(this,Y,"m",$0).call(this);const s=await e.chat.completions.create({...t,stream:!0},{...r,signal:this.controller.signal});this._connected();for await(const c of s)X(this,Y,"m",T0).call(this,c);if((o=s.controller.signal)!=null&&o.aborted)throw new _e;return this._addChatCompletion(X(this,Y,"m",St).call(this))}async _fromReadableStream(e,t){var o;const r=t==null?void 0:t.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),X(this,Y,"m",$0).call(this),this._connected();const a=we.fromReadableStream(e,this.controller);let s;for await(const c of a)s&&s!==c.id&&this._addChatCompletion(X(this,Y,"m",St).call(this)),X(this,Y,"m",T0).call(this,c),s=c.id;if((o=a.controller.signal)!=null&&o.aborted)throw new _e;return this._addChatCompletion(X(this,Y,"m",St).call(this))}[(Ee=new WeakMap,Le=new WeakMap,Se=new WeakMap,Y=new WeakSet,$0=function(){this.ended||We(this,Se,void 0,"f")},Dt=function(t){let r=X(this,Le,"f")[t.index];return r||(r={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},X(this,Le,"f")[t.index]=r,r)},T0=function(t){var a,s,o,c,v,i,x,_,l,u,p,g,h,B,f;if(this.ended)return;const r=X(this,Y,"m",In).call(this,t);this._emit("chunk",t,r);for(const d of t.choices){const m=r.choices[d.index];d.delta.content!=null&&((a=m.message)==null?void 0:a.role)==="assistant"&&((s=m.message)!=null&&s.content)&&(this._emit("content",d.delta.content,m.message.content),this._emit("content.delta",{delta:d.delta.content,snapshot:m.message.content,parsed:m.message.parsed})),d.delta.refusal!=null&&((o=m.message)==null?void 0:o.role)==="assistant"&&((c=m.message)!=null&&c.refusal)&&this._emit("refusal.delta",{delta:d.delta.refusal,snapshot:m.message.refusal}),((v=d.logprobs)==null?void 0:v.content)!=null&&((i=m.message)==null?void 0:i.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(x=d.logprobs)==null?void 0:x.content,snapshot:((_=m.logprobs)==null?void 0:_.content)??[]}),((l=d.logprobs)==null?void 0:l.refusal)!=null&&((u=m.message)==null?void 0:u.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(p=d.logprobs)==null?void 0:p.refusal,snapshot:((g=m.logprobs)==null?void 0:g.refusal)??[]});const w=X(this,Y,"m",Dt).call(this,m);m.finish_reason&&(X(this,Y,"m",M0).call(this,m),w.current_tool_call_index!=null&&X(this,Y,"m",H0).call(this,m,w.current_tool_call_index));for(const C of d.delta.tool_calls??[])w.current_tool_call_index!==C.index&&(X(this,Y,"m",M0).call(this,m),w.current_tool_call_index!=null&&X(this,Y,"m",H0).call(this,m,w.current_tool_call_index)),w.current_tool_call_index=C.index;for(const C of d.delta.tool_calls??[]){const A=(h=m.message.tool_calls)==null?void 0:h[C.index];A!=null&&A.type&&((A==null?void 0:A.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(B=A.function)==null?void 0:B.name,index:C.index,arguments:A.function.arguments,parsed_arguments:A.function.parsed_arguments,arguments_delta:((f=C.function)==null?void 0:f.arguments)??""}):(A==null||A.type,void 0))}}},H0=function(t,r){var o,c,v;if(X(this,Y,"m",Dt).call(this,t).done_tool_calls.has(r))return;const s=(o=t.message.tool_calls)==null?void 0:o[r];if(!s)throw new Error("no tool call snapshot");if(!s.type)throw new Error("tool call snapshot missing `type`");if(s.type==="function"){const i=(v=(c=X(this,Ee,"f"))==null?void 0:c.tools)==null?void 0:v.find(x=>x.type==="function"&&x.function.name===s.function.name);this._emit("tool_calls.function.arguments.done",{name:s.function.name,index:r,arguments:s.function.arguments,parsed_arguments:_t(i)?i.$parseRaw(s.function.arguments):i!=null&&i.function.strict?JSON.parse(s.function.arguments):null})}else s.type},M0=function(t){var a,s;const r=X(this,Y,"m",Dt).call(this,t);if(t.message.content&&!r.content_done){r.content_done=!0;const o=X(this,Y,"m",N0).call(this);this._emit("content.done",{content:t.message.content,parsed:o?o.$parseRaw(t.message.content):null})}t.message.refusal&&!r.refusal_done&&(r.refusal_done=!0,this._emit("refusal.done",{refusal:t.message.refusal})),(a=t.logprobs)!=null&&a.content&&!r.logprobs_content_done&&(r.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:t.logprobs.content})),(s=t.logprobs)!=null&&s.refusal&&!r.logprobs_refusal_done&&(r.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:t.logprobs.refusal}))},St=function(){if(this.ended)throw new q("stream has ended, this shouldn't happen");const t=X(this,Se,"f");if(!t)throw new q("request ended without sending any chunks");return We(this,Se,void 0,"f"),We(this,Le,[],"f"),to(t,X(this,Ee,"f"))},N0=function(){var r;const t=(r=X(this,Ee,"f"))==null?void 0:r.response_format;return Pa(t)?t:null},In=function(t){var r,a,s,o;let c=X(this,Se,"f");const{choices:v,...i}=t;c?Object.assign(c,i):c=We(this,Se,{...i,choices:[]},"f");for(const{delta:x,finish_reason:_,index:l,logprobs:u=null,...p}of t.choices){let g=c.choices[l];if(g||(g=c.choices[l]={finish_reason:_,index:l,message:{},logprobs:u,...p}),u)if(!g.logprobs)g.logprobs=Object.assign({},u);else{const{content:C,refusal:A,...b}=u;Object.assign(g.logprobs,b),C&&((r=g.logprobs).content??(r.content=[]),g.logprobs.content.push(...C)),A&&((a=g.logprobs).refusal??(a.refusal=[]),g.logprobs.refusal.push(...A))}if(_&&(g.finish_reason=_,X(this,Ee,"f")&&Ia(X(this,Ee,"f")))){if(_==="length")throw new da;if(_==="content_filter")throw new ha}if(Object.assign(g,p),!x)continue;const{content:h,refusal:B,function_call:f,role:d,tool_calls:m,...w}=x;if(Object.assign(g.message,w),B&&(g.message.refusal=(g.message.refusal||"")+B),d&&(g.message.role=d),f&&(g.message.function_call?(f.name&&(g.message.function_call.name=f.name),f.arguments&&((s=g.message.function_call).arguments??(s.arguments=""),g.message.function_call.arguments+=f.arguments)):g.message.function_call=f),h&&(g.message.content=(g.message.content||"")+h,!g.message.refusal&&X(this,Y,"m",N0).call(this)&&(g.message.parsed=Pn(g.message.content))),m){g.message.tool_calls||(g.message.tool_calls=[]);for(const{index:C,id:A,type:b,function:k,...y}of m){const E=(o=g.message.tool_calls)[C]??(o[C]={});Object.assign(E,y),A&&(E.id=A),b&&(E.type=b),k&&(E.function??(E.function={name:k.name??"",arguments:""})),k!=null&&k.name&&(E.function.name=k.name),k!=null&&k.arguments&&(E.function.arguments+=k.arguments,Gi(X(this,Ee,"f"),E)&&(E.function.parsed_arguments=Pn(E.function.arguments)))}}}return c},Symbol.asyncIterator)](){const e=[],t=[];let r=!1;return this.on("chunk",a=>{const s=t.shift();s?s.resolve(a):e.push(a)}),this.on("end",()=>{r=!0;for(const a of t)a.resolve(void 0);t.length=0}),this.on("abort",a=>{r=!0;for(const s of t)s.reject(a);t.length=0}),this.on("error",a=>{r=!0;for(const s of t)s.reject(a);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((s,o)=>t.push({resolve:s,reject:o})).then(s=>s?{value:s,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new we(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function to(n,e){const{id:t,choices:r,created:a,model:s,system_fingerprint:o,...c}=n,v={...c,id:t,choices:r.map(({message:i,finish_reason:x,index:_,logprobs:l,...u})=>{if(!x)throw new q(`missing finish_reason for choice ${_}`);const{content:p=null,function_call:g,tool_calls:h,...B}=i,f=i.role;if(!f)throw new q(`missing role for choice ${_}`);if(g){const{arguments:d,name:m}=g;if(d==null)throw new q(`missing function_call.arguments for choice ${_}`);if(!m)throw new q(`missing function_call.name for choice ${_}`);return{...u,message:{content:p,function_call:{arguments:d,name:m},role:f,refusal:i.refusal??null},finish_reason:x,index:_,logprobs:l}}return h?{...u,index:_,finish_reason:x,logprobs:l,message:{...B,role:f,content:p,refusal:i.refusal??null,tool_calls:h.map((d,m)=>{const{function:w,type:C,id:A,...b}=d,{arguments:k,name:y,...E}=w||{};if(A==null)throw new q(`missing choices[${_}].tool_calls[${m}].id
${kt(n)}`);if(C==null)throw new q(`missing choices[${_}].tool_calls[${m}].type
${kt(n)}`);if(y==null)throw new q(`missing choices[${_}].tool_calls[${m}].function.name
${kt(n)}`);if(k==null)throw new q(`missing choices[${_}].tool_calls[${m}].function.arguments
${kt(n)}`);return{...b,id:A,type:C,function:{...E,name:y,arguments:k}}})}}:{...u,message:{...B,content:p,role:f,refusal:i.refusal??null},finish_reason:x,index:_,logprobs:l}}),created:a,model:s,object:"chat.completion",...o?{system_fingerprint:o}:{}};return ji(v,e)}function kt(n){return JSON.stringify(n)}class Ge extends pt{static fromReadableStream(e){const t=new Ge(null);return t._run(()=>t._fromReadableStream(e)),t}static runFunctions(e,t,r){const a=new Ge(null),s={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return a._run(()=>a._runFunctions(e,t,s)),a}static runTools(e,t,r){const a=new Ge(t),s={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return a._run(()=>a._runTools(e,t,s)),a}}let Va=class extends z{parse(e,t){return Vi(e.tools),this._client.chat.completions.create(e,{...t,headers:{...t==null?void 0:t.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap(r=>cr(r,e))}runFunctions(e,t){return e.stream?Ge.runFunctions(this._client,e,t):ht.runFunctions(this._client,e,t)}runTools(e,t){return e.stream?Ge.runTools(this._client,e,t):ht.runTools(this._client,e,t)}stream(e,t){return pt.createChatCompletion(this._client,e,t)}};class Y0 extends z{constructor(){super(...arguments),this.completions=new Va(this._client)}}(function(n){n.Completions=Va})(Y0||(Y0={}));class Ja extends z{create(e,t){return this._client.post("/realtime/sessions",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class lr extends z{constructor(){super(...arguments),this.sessions=new Ja(this._client)}}lr.Sessions=Ja;var $=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},xe=function(n,e,t,r,a){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!a:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?a.call(n,t):a?a.value=t:e.set(n,t),t},re,Z0,Be,Ot,ve,$e,je,Oe,qt,ue,$t,Tt,dt,xt,ft,On,$n,Tn,Hn,Mn,Nn,qn;class ge extends Ra{constructor(){super(...arguments),re.add(this),Z0.set(this,[]),Be.set(this,{}),Ot.set(this,{}),ve.set(this,void 0),$e.set(this,void 0),je.set(this,void 0),Oe.set(this,void 0),qt.set(this,void 0),ue.set(this,void 0),$t.set(this,void 0),Tt.set(this,void 0),dt.set(this,void 0)}[(Z0=new WeakMap,Be=new WeakMap,Ot=new WeakMap,ve=new WeakMap,$e=new WeakMap,je=new WeakMap,Oe=new WeakMap,qt=new WeakMap,ue=new WeakMap,$t=new WeakMap,Tt=new WeakMap,dt=new WeakMap,re=new WeakSet,Symbol.asyncIterator)](){const e=[],t=[];let r=!1;return this.on("event",a=>{const s=t.shift();s?s.resolve(a):e.push(a)}),this.on("end",()=>{r=!0;for(const a of t)a.resolve(void 0);t.length=0}),this.on("abort",a=>{r=!0;for(const s of t)s.reject(a);t.length=0}),this.on("error",a=>{r=!0;for(const s of t)s.reject(a);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((s,o)=>t.push({resolve:s,reject:o})).then(s=>s?{value:s,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const t=new ge;return t._run(()=>t._fromReadableStream(e)),t}async _fromReadableStream(e,t){var s;const r=t==null?void 0:t.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),this._connected();const a=we.fromReadableStream(e,this.controller);for await(const o of a)$(this,re,"m",xt).call(this,o);if((s=a.controller.signal)!=null&&s.aborted)throw new _e;return this._addRun($(this,re,"m",ft).call(this))}toReadableStream(){return new we(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,t,r,a,s){const o=new ge;return o._run(()=>o._runToolAssistantStream(e,t,r,a,{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}})),o}async _createToolAssistantStream(e,t,r,a,s){var i;const o=s==null?void 0:s.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort()));const c={...a,stream:!0},v=await e.submitToolOutputs(t,r,c,{...s,signal:this.controller.signal});this._connected();for await(const x of v)$(this,re,"m",xt).call(this,x);if((i=v.controller.signal)!=null&&i.aborted)throw new _e;return this._addRun($(this,re,"m",ft).call(this))}static createThreadAssistantStream(e,t,r){const a=new ge;return a._run(()=>a._threadAssistantStream(e,t,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),a}static createAssistantStream(e,t,r,a){const s=new ge;return s._run(()=>s._runAssistantStream(e,t,r,{...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"stream"}})),s}currentEvent(){return $(this,$t,"f")}currentRun(){return $(this,Tt,"f")}currentMessageSnapshot(){return $(this,ve,"f")}currentRunStepSnapshot(){return $(this,dt,"f")}async finalRunSteps(){return await this.done(),Object.values($(this,Be,"f"))}async finalMessages(){return await this.done(),Object.values($(this,Ot,"f"))}async finalRun(){if(await this.done(),!$(this,$e,"f"))throw Error("Final run was not received.");return $(this,$e,"f")}async _createThreadAssistantStream(e,t,r){var c;const a=r==null?void 0:r.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const s={...t,stream:!0},o=await e.createAndRun(s,{...r,signal:this.controller.signal});this._connected();for await(const v of o)$(this,re,"m",xt).call(this,v);if((c=o.controller.signal)!=null&&c.aborted)throw new _e;return this._addRun($(this,re,"m",ft).call(this))}async _createAssistantStream(e,t,r,a){var v;const s=a==null?void 0:a.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));const o={...r,stream:!0},c=await e.create(t,o,{...a,signal:this.controller.signal});this._connected();for await(const i of c)$(this,re,"m",xt).call(this,i);if((v=c.controller.signal)!=null&&v.aborted)throw new _e;return this._addRun($(this,re,"m",ft).call(this))}static accumulateDelta(e,t){for(const[r,a]of Object.entries(t)){if(!e.hasOwnProperty(r)){e[r]=a;continue}let s=e[r];if(s==null){e[r]=a;continue}if(r==="index"||r==="type"){e[r]=a;continue}if(typeof s=="string"&&typeof a=="string")s+=a;else if(typeof s=="number"&&typeof a=="number")s+=a;else if(O0(s)&&O0(a))s=this.accumulateDelta(s,a);else if(Array.isArray(s)&&Array.isArray(a)){if(s.every(o=>typeof o=="string"||typeof o=="number")){s.push(...a);continue}for(const o of a){if(!O0(o))throw new Error(`Expected array delta entry to be an object but got: ${o}`);const c=o.index;if(c==null)throw console.error(o),new Error("Expected array delta entry to have an `index` property");if(typeof c!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${c}`);const v=s[c];v==null?s.push(o):s[c]=this.accumulateDelta(v,o)}continue}else throw Error(`Unhandled record type: ${r}, deltaValue: ${a}, accValue: ${s}`);e[r]=s}return e}_addRun(e){return e}async _threadAssistantStream(e,t,r){return await this._createThreadAssistantStream(t,e,r)}async _runAssistantStream(e,t,r,a){return await this._createAssistantStream(t,e,r,a)}async _runToolAssistantStream(e,t,r,a,s){return await this._createToolAssistantStream(r,e,t,a,s)}}xt=function(e){if(!this.ended)switch(xe(this,$t,e,"f"),$(this,re,"m",Tn).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":$(this,re,"m",qn).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":$(this,re,"m",$n).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":$(this,re,"m",On).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},ft=function(){if(this.ended)throw new q("stream has ended, this shouldn't happen");if(!$(this,$e,"f"))throw Error("Final run has not been received");return $(this,$e,"f")},On=function(e){const[t,r]=$(this,re,"m",Mn).call(this,e,$(this,ve,"f"));xe(this,ve,t,"f"),$(this,Ot,"f")[t.id]=t;for(const a of r){const s=t.content[a.index];(s==null?void 0:s.type)=="text"&&this._emit("textCreated",s.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(const a of e.data.delta.content){if(a.type=="text"&&a.text){let s=a.text,o=t.content[a.index];if(o&&o.type=="text")this._emit("textDelta",s,o.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(a.index!=$(this,je,"f")){if($(this,Oe,"f"))switch($(this,Oe,"f").type){case"text":this._emit("textDone",$(this,Oe,"f").text,$(this,ve,"f"));break;case"image_file":this._emit("imageFileDone",$(this,Oe,"f").image_file,$(this,ve,"f"));break}xe(this,je,a.index,"f")}xe(this,Oe,t.content[a.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if($(this,je,"f")!==void 0){const a=e.data.content[$(this,je,"f")];if(a)switch(a.type){case"image_file":this._emit("imageFileDone",a.image_file,$(this,ve,"f"));break;case"text":this._emit("textDone",a.text,$(this,ve,"f"));break}}$(this,ve,"f")&&this._emit("messageDone",e.data),xe(this,ve,void 0,"f")}},$n=function(e){const t=$(this,re,"m",Hn).call(this,e);switch(xe(this,dt,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const r=e.data.delta;if(r.step_details&&r.step_details.type=="tool_calls"&&r.step_details.tool_calls&&t.step_details.type=="tool_calls")for(const s of r.step_details.tool_calls)s.index==$(this,qt,"f")?this._emit("toolCallDelta",s,t.step_details.tool_calls[s.index]):($(this,ue,"f")&&this._emit("toolCallDone",$(this,ue,"f")),xe(this,qt,s.index,"f"),xe(this,ue,t.step_details.tool_calls[s.index],"f"),$(this,ue,"f")&&this._emit("toolCallCreated",$(this,ue,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":xe(this,dt,void 0,"f"),e.data.step_details.type=="tool_calls"&&$(this,ue,"f")&&(this._emit("toolCallDone",$(this,ue,"f")),xe(this,ue,void 0,"f")),this._emit("runStepDone",e.data,t);break}},Tn=function(e){$(this,Z0,"f").push(e),this._emit("event",e)},Hn=function(e){switch(e.event){case"thread.run.step.created":return $(this,Be,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=$(this,Be,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let r=e.data;if(r.delta){const a=ge.accumulateDelta(t,r.delta);$(this,Be,"f")[e.data.id]=a}return $(this,Be,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":$(this,Be,"f")[e.data.id]=e.data;break}if($(this,Be,"f")[e.data.id])return $(this,Be,"f")[e.data.id];throw new Error("No snapshot available")},Mn=function(e,t){let r=[];switch(e.event){case"thread.message.created":return[e.data,r];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let a=e.data;if(a.delta.content)for(const s of a.delta.content)if(s.index in t.content){let o=t.content[s.index];t.content[s.index]=$(this,re,"m",Nn).call(this,s,o)}else t.content[s.index]=s,r.push(s);return[t,r];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,r];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},Nn=function(e,t){return ge.accumulateDelta(t,e)},qn=function(e){switch(xe(this,Tt,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":xe(this,$e,e.data,"f"),$(this,ue,"f")&&(this._emit("toolCallDone",$(this,ue,"f")),xe(this,ue,void 0,"f"));break}};class xr extends z{create(e,t,r){return this._client.post(`/threads/${e}/messages`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,t,r){return this._client.get(`/threads/${e}/messages/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,t,r,a){return this._client.post(`/threads/${e}/messages/${t}`,{body:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}list(e,t={},r){return oe(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/messages`,fr,{query:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,t,r){return this._client.delete(`/threads/${e}/messages/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class fr extends ye{}xr.MessagesPage=fr;class ur extends z{retrieve(e,t,r,a={},s){return oe(a)?this.retrieve(e,t,r,{},a):this._client.get(`/threads/${e}/runs/${t}/steps/${r}`,{query:a,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,t,r={},a){return oe(r)?this.list(e,t,{},r):this._client.getAPIList(`/threads/${e}/runs/${t}/steps`,dr,{query:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}}class dr extends ye{}ur.RunStepsPage=dr;class gt extends z{constructor(){super(...arguments),this.steps=new ur(this._client)}create(e,t,r){const{include:a,...s}=t;return this._client.post(`/threads/${e}/runs`,{query:{include:a},body:s,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers},stream:t.stream??!1})}retrieve(e,t,r){return this._client.get(`/threads/${e}/runs/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,t,r,a){return this._client.post(`/threads/${e}/runs/${t}`,{body:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}list(e,t={},r){return oe(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/runs`,hr,{query:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(e,t,r){return this._client.post(`/threads/${e}/runs/${t}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,t,r){const a=await this.create(e,t,r);return await this.poll(e,a.id,r)}createAndStream(e,t,r){return ge.createAssistantStream(e,this._client.beta.threads.runs,t,r)}async poll(e,t,r){const a={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(a["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:s,response:o}=await this.retrieve(e,t,{...r,headers:{...r==null?void 0:r.headers,...a}}).withResponse();switch(s.status){case"queued":case"in_progress":case"cancelling":let c=5e3;if(r!=null&&r.pollIntervalMs)c=r.pollIntervalMs;else{const v=o.headers.get("openai-poll-after-ms");if(v){const i=parseInt(v);isNaN(i)||(c=i)}}await mt(c);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return s}}}stream(e,t,r){return ge.createAssistantStream(e,this._client.beta.threads.runs,t,r)}submitToolOutputs(e,t,r,a){return this._client.post(`/threads/${e}/runs/${t}/submit_tool_outputs`,{body:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers},stream:r.stream??!1})}async submitToolOutputsAndPoll(e,t,r,a){const s=await this.submitToolOutputs(e,t,r,a);return await this.poll(e,s.id,a)}submitToolOutputsStream(e,t,r,a){return ge.createToolAssistantStream(e,t,this._client.beta.threads.runs,r,a)}}class hr extends ye{}gt.RunsPage=hr;gt.Steps=ur;gt.RunStepsPage=dr;class Je extends z{constructor(){super(...arguments),this.runs=new gt(this._client),this.messages=new xr(this._client)}create(e={},t){return oe(e)?this.create({},e):this._client.post("/threads",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(e,t,r){return this._client.post(`/threads/${e}`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,t){return this._client.delete(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}createAndRun(e,t){return this._client.post("/threads/runs",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers},stream:e.stream??!1})}async createAndRunPoll(e,t){const r=await this.createAndRun(e,t);return await this.runs.poll(r.thread_id,r.id,t)}createAndRunStream(e,t){return ge.createThreadAssistantStream(e,this._client.beta.threads,t)}}Je.Runs=gt;Je.RunsPage=hr;Je.Messages=xr;Je.MessagesPage=fr;const ro=async n=>{const e=await Promise.allSettled(n),t=e.filter(a=>a.status==="rejected");if(t.length){for(const a of t)console.error(a.reason);throw new Error(`${t.length} promise(s) failed - see the above errors`)}const r=[];for(const a of e)a.status==="fulfilled"&&r.push(a.value);return r};let pr=class extends z{create(e,t,r){return this._client.post(`/vector_stores/${e}/files`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,t,r){return this._client.get(`/vector_stores/${e}/files/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e,t={},r){return oe(t)?this.list(e,{},t):this._client.getAPIList(`/vector_stores/${e}/files`,Xt,{query:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,t,r){return this._client.delete(`/vector_stores/${e}/files/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,t,r){const a=await this.create(e,t,r);return await this.poll(e,a.id,r)}async poll(e,t,r){const a={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(a["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const s=await this.retrieve(e,t,{...r,headers:a}).withResponse(),o=s.data;switch(o.status){case"in_progress":let c=5e3;if(r!=null&&r.pollIntervalMs)c=r.pollIntervalMs;else{const v=s.response.headers.get("openai-poll-after-ms");if(v){const i=parseInt(v);isNaN(i)||(c=i)}}await mt(c);break;case"failed":case"completed":return o}}}async upload(e,t,r){const a=await this._client.files.create({file:t,purpose:"assistants"},r);return this.create(e,{file_id:a.id},r)}async uploadAndPoll(e,t,r){const a=await this.upload(e,t,r);return await this.poll(e,a.id,r)}};class Xt extends ye{}pr.VectorStoreFilesPage=Xt;class Qa extends z{create(e,t,r){return this._client.post(`/vector_stores/${e}/file_batches`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,t,r){return this._client.get(`/vector_stores/${e}/file_batches/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(e,t,r){return this._client.post(`/vector_stores/${e}/file_batches/${t}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,t,r){const a=await this.create(e,t);return await this.poll(e,a.id,r)}listFiles(e,t,r={},a){return oe(r)?this.listFiles(e,t,{},r):this._client.getAPIList(`/vector_stores/${e}/file_batches/${t}/files`,Xt,{query:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}async poll(e,t,r){const a={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(a["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:s,response:o}=await this.retrieve(e,t,{...r,headers:a}).withResponse();switch(s.status){case"in_progress":let c=5e3;if(r!=null&&r.pollIntervalMs)c=r.pollIntervalMs;else{const v=o.headers.get("openai-poll-after-ms");if(v){const i=parseInt(v);isNaN(i)||(c=i)}}await mt(c);break;case"failed":case"cancelled":case"completed":return s}}}async uploadAndPoll(e,{files:t,fileIds:r=[]},a){if(t==null||t.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const s=(a==null?void 0:a.maxConcurrency)??5,o=Math.min(s,t.length),c=this._client,v=t.values(),i=[...r];async function x(l){for(let u of l){const p=await c.files.create({file:u,purpose:"assistants"},a);i.push(p.id)}}const _=Array(o).fill(v).map(x);return await ro(_),await this.createAndPoll(e,{file_ids:i})}}class Qe extends z{constructor(){super(...arguments),this.files=new pr(this._client),this.fileBatches=new Qa(this._client)}create(e,t){return this._client.post("/vector_stores",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(e,t,r){return this._client.post(`/vector_stores/${e}`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e={},t){return oe(e)?this.list({},e):this._client.getAPIList("/vector_stores",mr,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}del(e,t){return this._client.delete(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class mr extends ye{}Qe.VectorStoresPage=mr;Qe.Files=pr;Qe.VectorStoreFilesPage=Xt;Qe.FileBatches=Qa;class Re extends z{constructor(){super(...arguments),this.realtime=new lr(this._client),this.vectorStores=new Qe(this._client),this.chat=new Y0(this._client),this.assistants=new ir(this._client),this.threads=new Je(this._client)}}Re.Realtime=lr;Re.VectorStores=Qe;Re.VectorStoresPage=mr;Re.Assistants=ir;Re.AssistantsPage=or;Re.Threads=Je;class Ya extends z{create(e,t){return this._client.post("/completions",{body:e,...t,stream:e.stream??!1})}}class Za extends z{create(e,t){return this._client.post("/embeddings",{body:e,...t})}}class vr extends z{create(e,t){return this._client.post("/files",Ve({body:e,...t}))}retrieve(e,t){return this._client.get(`/files/${e}`,t)}list(e={},t){return oe(e)?this.list({},e):this._client.getAPIList("/files",_r,{query:e,...t})}del(e,t){return this._client.delete(`/files/${e}`,t)}content(e,t){return this._client.get(`/files/${e}/content`,{...t,headers:{Accept:"application/binary",...t==null?void 0:t.headers},__binaryResponse:!0})}retrieveContent(e,t){return this._client.get(`/files/${e}/content`,t)}async waitForProcessing(e,{pollInterval:t=5e3,maxWait:r=30*60*1e3}={}){const a=new Set(["processed","error","deleted"]),s=Date.now();let o=await this.retrieve(e);for(;!o.status||!a.has(o.status);)if(await mt(t),o=await this.retrieve(e),Date.now()-s>r)throw new rr({message:`Giving up on waiting for file ${e} to finish processing after ${r} milliseconds.`});return o}}class _r extends ye{}vr.FileObjectsPage=_r;class gr extends z{list(e,t={},r){return oe(t)?this.list(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,yr,{query:t,...r})}}class yr extends ye{}gr.FineTuningJobCheckpointsPage=yr;class Ye extends z{constructor(){super(...arguments),this.checkpoints=new gr(this._client)}create(e,t){return this._client.post("/fine_tuning/jobs",{body:e,...t})}retrieve(e,t){return this._client.get(`/fine_tuning/jobs/${e}`,t)}list(e={},t){return oe(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",Cr,{query:e,...t})}cancel(e,t){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,t)}listEvents(e,t={},r){return oe(t)?this.listEvents(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,Ar,{query:t,...r})}}class Cr extends ye{}class Ar extends ye{}Ye.FineTuningJobsPage=Cr;Ye.FineTuningJobEventsPage=Ar;Ye.Checkpoints=gr;Ye.FineTuningJobCheckpointsPage=yr;class yt extends z{constructor(){super(...arguments),this.jobs=new Ye(this._client)}}yt.Jobs=Ye;yt.FineTuningJobsPage=Cr;yt.FineTuningJobEventsPage=Ar;class es extends z{createVariation(e,t){return this._client.post("/images/variations",Ve({body:e,...t}))}edit(e,t){return this._client.post("/images/edits",Ve({body:e,...t}))}generate(e,t){return this._client.post("/images/generations",{body:e,...t})}}class Br extends z{retrieve(e,t){return this._client.get(`/models/${e}`,t)}list(e){return this._client.getAPIList("/models",wr,e)}del(e,t){return this._client.delete(`/models/${e}`,t)}}class wr extends Ui{}Br.ModelsPage=wr;class ts extends z{create(e,t){return this._client.post("/moderations",{body:e,...t})}}class rs extends z{create(e,t,r){return this._client.post(`/uploads/${e}/parts`,Ve({body:t,...r}))}}class Er extends z{constructor(){super(...arguments),this.parts=new rs(this._client)}create(e,t){return this._client.post("/uploads",{body:e,...t})}cancel(e,t){return this._client.post(`/uploads/${e}/cancel`,t)}complete(e,t,r){return this._client.post(`/uploads/${e}/complete`,{body:t,...r})}}Er.Parts=rs;var ns;class L extends Ri{constructor({baseURL:e=bt("OPENAI_BASE_URL"),apiKey:t=bt("OPENAI_API_KEY"),organization:r=bt("OPENAI_ORG_ID")??null,project:a=bt("OPENAI_PROJECT_ID")??null,...s}={}){if(t===void 0)throw new q("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const o={apiKey:t,organization:r,project:a,...s,baseURL:e||"https://api.openai.com/v1"};if(!o.dangerouslyAllowBrowser&&Li())throw new q(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:o.baseURL,timeout:o.timeout??6e5,httpAgent:o.httpAgent,maxRetries:o.maxRetries,fetch:o.fetch}),this.completions=new Ya(this),this.chat=new nr(this),this.embeddings=new Za(this),this.files=new vr(this),this.images=new es(this),this.audio=new vt(this),this.moderations=new ts(this),this.models=new Br(this),this.fineTuning=new yt(this),this.beta=new Re(this),this.batches=new ar(this),this.uploads=new Er(this),this._options=o,this.apiKey=t,this.organization=r,this.project=a}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return di(e,{arrayFormat:"brackets"})}}ns=L;L.OpenAI=ns;L.DEFAULT_TIMEOUT=6e5;L.OpenAIError=q;L.APIError=ne;L.APIConnectionError=Lt;L.APIConnectionTimeoutError=rr;L.APIUserAbortError=_e;L.NotFoundError=ca;L.ConflictError=la;L.RateLimitError=fa;L.BadRequestError=sa;L.AuthenticationError=ia;L.InternalServerError=ua;L.PermissionDeniedError=oa;L.UnprocessableEntityError=xa;L.toFile=_a;L.fileFromPath=na;L.Completions=Ya;L.Chat=nr;L.Embeddings=Za;L.Files=vr;L.FileObjectsPage=_r;L.Images=es;L.Audio=vt;L.Moderations=ts;L.Models=Br;L.ModelsPage=wr;L.FineTuning=yt;L.Beta=Re;L.Batches=ar;L.BatchesPage=sr;L.Uploads=Er;const as=L,no=async(n,e,t)=>{try{const a=await new as({apiKey:t.apiKey,dangerouslyAllowBrowser:!0,timeout:5e3}).chat.completions.create({model:"gpt-3.5-turbo",messages:n,stream:!0});for await(const s of a)s.choices&&chrome.tabs.sendMessage(e.tab.id,{action:"websocketMessage",data:s.choices[0].delta.content})}catch(r){await chrome.tabs.sendMessage(e.tab.id,{action:"configError",data:String(r)})}},ss={spark3_5:{name:"spark3_5",path:"wss://spark-api.xf-yun.com/v3.5/chat",version:"v3.5",domain:"generalv3.5"},spark3:{name:"spark3",path:"wss://spark-api.xf-yun.com/v3.1/chat",version:"v3.1",domain:"generalv3"},spark2:{name:"spark2",path:"wss://spark-api.xf-yun.com/v2.1/chat",version:"v2",domain:"generalv2"},spark1_5:{name:"spark1_5",path:"wss://spark-api.xf-yun.com/v1.1/chat",version:"v1.5",domain:"general"},gpt35_turbo:{name:"gpt-3.5-turbo",path:"empty",version:"empty",domain:"empty"},ernie_35:{name:"ernie-3.5",path:"https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/completions",version:"empty",domain:"empty"},ernie_40:{name:"ernie-4.0",path:"https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/completions_pro",version:"empty",domain:"empty"},qwen_turbo:{name:"qwen-turbo",path:"https://dashscope.aliyuncs.com/api/v1/services/aigc/text-generation/generation",version:"empty",domain:"empty"},qwen_plus:{name:"qwen-plus",path:"https://dashscope.aliyuncs.com/api/v1/services/aigc/text-generation/generation",version:"empty",domain:"empty"},qwen_max:{name:"qwen-max",path:"https://dashscope.aliyuncs.com/api/v1/services/aigc/text-generation/generation",version:"empty",domain:"empty"},deepseek_chat:{name:"deepseek-chat",path:"empty",version:"empty",domain:"empty"},deepseek_reasoner:{name:"deepseek-reasoner",path:"empty",version:"empty",domain:"empty"}},ao="https://aip.baidubce.com/oauth/2.0/token",so=n=>{var t;return(t=Object.values(ss).find(r=>r.name===n))==null?void 0:t.path},io=(n,e)=>`${ao}?grant_type=client_credentials&client_id=${n}&client_secret=${e}`,oo=(n,e)=>`${so(e)}?access_token=${n}`,co=(n,e)=>new Promise(async(t,r)=>{try{const s=await(await fetch(io(n,e),{method:"POST",headers:{"Content-Type":"application/json"}})).json();s.access_token?t(s.access_token):r("network error")}catch(a){r(a)}}),lo=(n,e)=>{new TextDecoder("utf-8").decode(n).split("data:").forEach(s=>{if(s){const{result:o}=JSON.parse(s);o&&chrome.tabs.sendMessage(e.tab.id,{action:"websocketMessage",data:o})}})},xo=(n,e,t,r)=>new Promise(async(a,s)=>{try{const c=(await fetch(oo(t,r),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:n,stream:!0})})).body.getReader();for(;;){const{done:v,value:i}=await c.read();if(v)break;lo(i,e)}}catch(o){s(o)}}),fo=async(n,e,t,r)=>{try{const{apiKey:a,apiSecret:s}=t,o=await co(a,s);await xo(n,e,o,r)}catch(a){await chrome.tabs.sendMessage(e.tab.id,{action:"configError",data:String(a)})}},uo=n=>{var t;return(t=Object.values(ss).find(r=>r.name===n))==null?void 0:t.path},ho=async(n,e,t,r)=>{const o=new TextDecoder("utf-8").decode(n).split("data:");if(o.length>1){const{output:{text:c}}=JSON.parse(o[1]),v=c.substring(t);return v&&await chrome.tabs.sendMessage(e.tab.id,{action:"websocketMessage",data:v}),c.length}else r("No result, Please check your model config")},po=(n,e,t,r)=>new Promise(async(a,s)=>{try{const c=(await fetch(uo(r),{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`,"X-DashScope-SSE":"enable"},body:JSON.stringify({model:r,input:{messages:n}})})).body.getReader();let v=0;for(;;){const{done:i,value:x}=await c.read();if(i)break;v=await ho(x,e,v,s)}}catch(o){s(o)}}),mo=async(n,e,t,r)=>{try{const{apiKey:a}=t;await po(n,e,a,r)}catch(a){await chrome.tabs.sendMessage(e.tab.id,{action:"configError",data:String(a)})}},vo=async(n,e,t,r)=>{var a;try{const o=await new as({baseURL:"https://maas-api.cn-huabei-1.xf-yun.com/v1",apiKey:t.apiKey,dangerouslyAllowBrowser:!0,timeout:5e3}).chat.completions.create({model:"xdeepseekr1",messages:n,stream:!0});for await(const c of o)c.choices&&chrome.tabs.sendMessage(e.tab.id,{action:"websocketMessage",data:c.choices[0].delta.content,reasoningContent:(a=c.choices[0].delta)==null?void 0:a.reasoning_content,hasReasoningContent:r==="deepseek-reasoner"})}catch(s){console.log(s),await chrome.tabs.sendMessage(e.tab.id,{action:"configError",data:String(s)})}},_o=()=>new Promise((n,e)=>{chrome.storage.local.get(["modelConfig"],t=>{t.modelConfig?n(t.modelConfig):e("请在插件设置界面配置模型参数后重试")})});try{chrome.contextMenus.create({id:"search",title:"Chat in browser",type:"normal",contexts:["selection"]})}catch(n){console.log(n)}chrome.contextMenus.onClicked.addListener(async(n,e)=>{n.menuItemId==="search"&&await chrome.tabs.sendMessage(e.id,{action:"userCopy",data:n.selectionText})});chrome.runtime.onMessage.addListener(async({action:n,data:e},t,r)=>{if(n==="search"){let a=null;try{a=await _o();const{messages:s,searchValue:o,copyValue:c}=e;s.forEach(v=>{delete v.model}),s.length===0?s.push({role:"user",content:await ri(o,c)}):s.push({role:"user",content:o}),a.model==="SparkApi"?await ei(s,t,a.sparkModelConfig):a.model==="OpenAI"?await no(s,t,a.openAiModelConfig):a.model==="WenxinYiyan"?await fo(s,t,a.wenxinModelConfig,a.modelName):a.model==="Tongyi"?await mo(s,t,a.tongyiModelConfig,a.modelName):a.model==="Deepseek"&&await vo(s,t,a.deepseekModelConfig,a.modelName)}catch(s){await chrome.tabs.sendMessage(t.tab.id,{action:"configError",data:s})}}});
